
                <!DOCTYPE html>
                <html lang="zh">
                <head>
                  <meta charset="UTF-8">
                  <meta name="viewport" content="width=device-width, initial-scale=1.0">
                  <title>论坛</title>
                  <style>
                    *,
                    *::before,
                    *::after {
                      box-sizing: border-box;
                      margin: 0;
                    }
                    .iframe-outer {
                      position: fixed;
                      top: 0;
                      left: 0;
                      bottom: 0;
                      right: 0;
                      display: flex;
                      justify-content: center;
                      background-color: #E0E0E0;
                    }
                    .iframe-wrapper {
                      width: 100%;
                      height: 100%;
                      margin: 0 auto;
                      transform-origin: center top;
                      flex-shrink: 0;
                    }
                    #dynamicIframe {
                      border: none;
                      width: 100%;
                      height: 100%;
                    }
                  </style>
                  <script>
                const width = 1920
                const height = 1080
                const resolutionRatio = width && height ? width / height : 1
                const pageNameMap = {
                  'home_page': '首页',
    'login_register_page': '登录注册',
    'registration_success_page': '注册成功',
    'password_reset_page': '找回密码',
    'graph_list_page': '图谱列表页',
    'graph_detail_page': '图谱详情页',
    'user_profile_page': '个人中心',
    'documentation_page': '文档',
    'about_page': '关于我们',
    'feedback_page': '用户反馈',
    'page_998124': '管理',
    'page_998125': '论坛'
                }
                function setIframeSize(w, h) {
                  const currentContainerRadio = w / h
                  let widthValue = w
                  let heightValue = h
                  let zoom = 1
                  if (currentContainerRadio > resolutionRatio) {
                    widthValue = h * resolutionRatio
                    heightValue = h
                  } else {
                    widthValue = w
                    heightValue = w / resolutionRatio
                  }
                  zoom = width ? widthValue / width : 1
                  return {
                    width: widthValue / zoom + 'px',
                    height: heightValue / zoom + 'px',
                    zoom,
                  }
                }
                function adjustIframeSize() {
                  const iframeWrapper = document.querySelector(".iframe-wrapper")
                  if (!iframeWrapper) return
                  iframeWrapper.style.width = '100%'
                  iframeWrapper.style.height = window.innerHeight + 'px'
                  iframeWrapper.style.transform = ''
                }
                function sanitizeFilename(name) {
                  return name.replace(/[\/:*?"<>|]/g, '_')
                }
                function handlePostMessage(event) {
                  if (!event.data) {
                    return
                  }
                  const { type, targetPageId } = event.data
                  const targetPageName = pageNameMap[targetPageId]
                  if (type === "iframeNavigation" && targetPageId && targetPageName) {
                    window.location.href = targetPageName + '.html'
                  }
                }
                window.addEventListener('message', handlePostMessage)
                window.onload = adjustIframeSize
                window.onresize = adjustIframeSize
                window.onunload = () => {
                  window.removeEventListener('message', handlePostMessage)
                }
              </script>
                </head>
                <body>
                  <div class="iframe-outer">
                    <div class="iframe-wrapper">
                      <iframe id="dynamicIframe" srcdoc='<html lang="zh-CN" data-theme="corporate"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论坛 - Graph+知识图谱平台</title>
    <link href="./assets/static/libs/daisyui@5.css" rel="stylesheet" type="text/css">
    <script src="./assets/static/libs/tailwind-browser@4.js"></script>
    <link href="./assets/static/libs/daisyui-themes.css" rel="stylesheet" type="text/css">
    <script src="./assets/3/3.1.1/iconify.min.js"></script>
    <style>
/* daisyUI Theme Variables Customization
* Based on the selected daisyUI theme and UI guidance requirements,
* customize only the CSS variables that need to be different from the theme defaults.
*/
:root {
/* Corporate theme customization for knowledge graph platform */
--color-primary: rgba(30, 58, 138, 1); /* Deep Blue #1E3A8A - 学院风深蓝 */
--color-primary-content: rgba(255, 255, 255, 1);
--color-secondary: rgba(37, 99, 235, 1); /* Medium Blue #2563EB */
--color-secondary-content: rgba(255, 255, 255, 1);
--color-accent: rgba(16, 185, 129, 1); /* Emerald Green #10B981 */
--color-accent-content: rgba(255, 255, 255, 1);
--color-base-100: rgba(255, 255, 255, 1);
--color-base-200: rgba(247, 249, 250, 1); /* #F7F9FA */
--color-base-300: rgba(229, 231, 235, 1); /* #E5E7EB */
--color-base-content: rgba(55, 65, 81, 1); /* #374151 */
--color-success: rgba(16, 185, 129, 1);
--color-warning: rgba(245, 158, 11, 1);
--color-error: rgba(239, 68, 68, 1);
--color-info: rgba(59, 130, 246, 1);
--radius-box: 0.375rem; /* 6px for micro-rounded corners */
--radius-field: 0.375rem;
--border: 1px;
}

/* Global component styles */
.transition-width {
transition: width 0.3s ease-in-out;
}

.nav-hover {
transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out;
}

.shadow-soft {
box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

/* Header height consistency */
.header-height {
height: 64px;
}

/* Focus styles for accessibility */
.focus-primary:focus {
outline: 2px solid var(--color-primary);
outline-offset: 2px;
}

/* Academic style enhancements */
.academic-border {
border: var(--border) solid var(--color-base-300);
}

.hover-lift {
transition: transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.hover-lift:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Professional grid spacing */
.academic-grid {
gap: 1.5rem;
}

/* Clean divider lines */
.academic-divider {
border-color: var(--color-base-300);
border-width: var(--border);
}
</style> <style>
/* Forum-specific styles */
.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.like-btn.liked .iconify {
    color: var(--color-error);
    animation: likeAnimation 0.3s ease-in-out;
}

@keyframes likeAnimation {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.comments-section {
    animation: slideDown 0.3s ease-in-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        max-height: 0;
    }
    to {
        opacity: 1;
        max-height: 500px;
    }
}

/* Skeleton loading for posts */
.post-skeleton {
    background: linear-gradient(90deg, var(--color-base-200) 25%, var(--color-base-300) 50%, var(--color-base-200) 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

@keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Smooth transitions for interactive elements */
.transition-colors {
    transition: color 0.15s ease-in-out;
}

/* Forum stats cards gradient enhancement */
.card.bg-gradient-to-r {
    position: relative;
    overflow: hidden;
}

.card.bg-gradient-to-r::before {
    content: &#39;&#39;;
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease-in-out;
}

.card.bg-gradient-to-r:hover::before {
    left: 100%;
}

/* Enhanced sidebar styling */
.sidebar-wrapper {
    position: sticky;
    top: 64px;
    height: calc(100vh - 64px);
    overflow-y: auto;
}

.sidebar-wrapper::-webkit-scrollbar {
    width: 4px;
}

.sidebar-wrapper::-webkit-scrollbar-track {
    background: var(--color-base-200);
}

.sidebar-wrapper::-webkit-scrollbar-thumb {
    background: var(--color-base-300);
    border-radius: 2px;
}

.sidebar-wrapper::-webkit-scrollbar-thumb:hover {
    background: var(--color-primary);
}

/* Online status indicator */
.online-indicator {
    position: relative;
}

.online-indicator::after {
    content: &#39;&#39;;
    position: absolute;
    top: -2px;
    right: -2px;
    width: 8px;
    height: 8px;
    background: var(--color-success);
    border: 2px solid var(--color-base-100);
    border-radius: 50%;
}

/* Enhanced modal styling */
.modal-box {
    background: var(--color-base-100);
    border: var(--border) solid var(--color-base-300);
}

/* Private message modal specific styling */
#privateMessageModal .modal-box {
    border-radius: var(--radius-box);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

#privateMessageModal .textarea {
    resize: none;
    transition: border-color 0.15s ease-in-out;
}

#privateMessageModal .textarea:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(30, 58, 138, 0.1);
}

/* Character counter styling */
#charCount {
    transition: color 0.15s ease-in-out;
    font-weight: 500;
}

/* Send button animation */
#privateMessageModal .btn-primary {
    transition: all 0.15s ease-in-out;
}

#privateMessageModal .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

/* Modal backdrop blur effect */
#privateMessageModal .modal-backdrop,
#quickCommentModal .modal-backdrop {
    backdrop-filter: blur(2px);
    background-color: rgba(0, 0, 0, 0.3);
}

/* Quick comment modal specific styling */
#quickCommentModal .modal-box {
    border-radius: var(--radius-box);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

#quickCommentModal .textarea {
    resize: none;
    transition: border-color 0.15s ease-in-out;
}

#quickCommentModal .textarea:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(30, 58, 138, 0.1);
}

/* Quick comment character counter styling */
#quickCommentCharCount {
    transition: color 0.15s ease-in-out;
    font-weight: 500;
}

/* Quick comment submit button animation */
#quickCommentModal .btn-primary {
    transition: all 0.15s ease-in-out;
}

#quickCommentModal .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

/* Responsive adjustments */
@media (max-width: 1280px) {
    .sidebar-wrapper {
        width: 16rem;
    }
}

@media (max-width: 1024px) {
    .sidebar-wrapper {
        display: none;
    }
    
    .main-content-wrapper {
        width: 100%;
    }
}
@media (max-width: 640px) {
    .header-height { height: 56px; }
}

/* Academic style enhancements for forum */
.academic-post-card {
    border: var(--border) solid var(--color-base-300);
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.academic-post-card:hover {
    border-color: var(--color-primary);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.1);
}

/* Enhanced button styles for forum actions */
.forum-action-btn {
    transition: all 0.15s ease-in-out;
    border-radius: var(--radius-field);
}

.forum-action-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Share modal specific styling */
#shareModal .modal-box {
    border-radius: var(--radius-box);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

#shareModal .input {
    background-color: var(--color-base-200);
    border-color: var(--color-base-300);
    color: var(--color-base-content);
}

#shareModal .input:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(30, 58, 138, 0.1);
}

/* Copy button animation */
#shareModal .btn-primary {
    transition: all 0.15s ease-in-out;
}

#shareModal .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

#shareModal .btn-primary.copied {
    background-color: var(--color-success);
    border-color: var(--color-success);
    animation: copySuccess 0.3s ease-in-out;
}

@keyframes copySuccess {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

/* Social share buttons */
#shareModal .btn-outline {
    transition: all 0.15s ease-in-out;
    border-color: var(--color-base-300);
}

#shareModal .btn-outline:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Share modal backdrop */
#shareModal .modal-backdrop {
    backdrop-filter: blur(2px);
    background-color: rgba(0, 0, 0, 0.3);
}
</style>
  <script src="./assets/static/libs/25_6/holder.js"></script></head>
  <body class="bg-base-200 min-h-screen">
    <div class="header-wrapper sticky top-0 z-40"><div data-section-id="common_header" data-section-type="common_header">
  <div id="ia8i" class="navbar bg-base-100 shadow-soft border-b academic-border header-height px-4 ia8i spark-custom-ia8i ia8i">
    <!-- Left section: Logo -->
    <div class="navbar-start">
      <div class="flex items-center cursor-pointer" onclick="navigateTo(&#39;home_page&#39;)">
        <img alt="Graph+知识图谱平台 Logo" class="w-10 h-10" data-src="placehold.co/40x40.png?text=KG"><span class="ml-3 text-xl font-semibold text-primary hidden lg:block">Graph+知识图谱平台</span>
      </div>
      <!-- Mobile menu -->
      <div class="dropdown lg:hidden ml-2">
        <div tabindex="0" role="button" class="btn btn-ghost btn-sm">
          <span class="iconify" data-icon="heroicons:bars-3" data-width="22"></span>
        </div>
        <ul tabindex="0" class="dropdown-content z-50 menu p-2 shadow-lg bg-base-100 rounded-box w-52 mt-2">
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;home_page&#39;)">首页</a></li>
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;graph_list_page&#39;)">探索</a></li>
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;page_998125&#39;)">论坛</a></li>
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;page_998124&#39;)">管理</a></li>
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;documentation_page&#39;)">使用文档</a></li>
          <li><a class="nav-hover focus-primary" onclick="navigateTo(&#39;about_page&#39;)">关于我们</a></li>
        </ul>
      </div>
    </div>
    <!-- Center section: Main navigation -->
    <div class="navbar-center hidden xl:flex">
      <ul class="menu menu-horizontal px-1 gap-1">
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;home_page&#39;)">首页</a>
        </li>
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;graph_list_page&#39;)">探索</a>
        </li>
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;page_998125&#39;)">论坛</a>
        </li>
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;page_998124&#39;)">管理</a>
        </li>
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;documentation_page&#39;)">使用文档</a>
        </li>
        <li>
          <a class="nav-hover focus-primary" onclick="navigateTo(&#39;about_page&#39;)">关于我们</a>
        </li>
      </ul>
    </div>
    <!-- Right section: User controls -->
    <div class="navbar-end">
      <!-- Login/Register buttons for logged-out users -->
      <div data-user-control="logged-out" class="flex items-center gap-2">
        <button class="btn btn-ghost btn-sm nav-hover focus-primary" onclick="navigateTo(&#39;login_register_page&#39;)">
          登录</button><button class="btn btn-primary btn-sm focus-primary" onclick="navigateTo(&#39;login_register_page&#39;)">
          注册
        </button>
      </div>
      <!-- User profile dropdown for logged-in users -->
      <div data-user-control="logged-in" id="ienac" class="dropdown dropdown-end" style="display: none;">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar focus-primary">
          <div class="avatar placeholder inline-flex items-center justify-center w-10 h-10 rounded-full bg-primary text-primary-content">
            <span class="font-semibold text-lg">用</span>
          </div>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-50 p-2 shadow-soft bg-base-100 rounded-box w-52">
          <li class="menu-title"><span>用户中心</span></li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateTo(&#39;user_profile_page&#39;)"><span class="iconify" data-icon="heroicons:user" data-width="16"></span><span>个人资料</span></a>
          </li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateTo(&#39;user_profile_page&#39;)"><span class="iconify" data-icon="heroicons:heart" data-width="16"></span><span>我的收藏</span></a>
          </li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateTo(&#39;user_profile_page&#39;)"><span class="iconify" data-icon="heroicons:clock" data-width="16"></span><span>历史记录</span></a>
          </li>
          <div class="divider my-1"></div>
          <li>
            <a class="nav-hover focus-primary text-error" onclick="window.APP_GLOBALS.user.logout()"><span class="iconify" data-icon="heroicons:arrow-right-on-rectangle" data-width="16"></span><span>退出登录</span></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
</div>
    <!-- Main Layout -->
    <div class="flex flex-1 min-h-screen">
      <!-- Left Sidebar - Filter -->
      <div id="idkri" class="sidebar-wrapper w-80 bg-base-100 border-r academic-border idkri spark-custom-idkri idkri">
        <div class="p-6">
          <h2 class="text-lg font-semibold text-base-content mb-4 flex items-center gap-2">
            <span class="iconify text-primary" data-icon="heroicons:funnel" data-width="20"></span>
            筛选与检索
          </h2>
          <!-- Search Box -->
          <div class="form-control mb-4">
            <label class="label"><span class="label-text">关键字搜索</span></label>
            <div class="join">
              <input type="text" placeholder="输入关键字..." id="searchInput" class="input input-bordered join-item flex-1"><button class="btn btn-primary join-item" onclick="performSearch()">
                <span class="iconify" data-icon="heroicons:magnifying-glass" data-width="16"></span>
              </button>
            </div>
          </div>
          <!-- Content Search -->
          <div class="form-control mb-4">
            <label class="label"><span class="label-text">内容搜索</span></label><input type="text" placeholder="搜索帖子内容..." id="contentFilter" class="input input-bordered contentFilter spark-custom-contentFilter">
          </div>
          <!-- Domain Filter -->
          <div class="form-control mb-4">
            <label class="label"><span class="label-text">领域分类</span></label><select id="domainFilter" class="select select-bordered domainFilter spark-custom-domainFilter">
              <option value="">全部领域</option>
              <option value="ai">人工智能</option>
              <option value="ml">机器学习</option>
              <option value="nlp">自然语言处理</option>
              <option value="cv">计算机视觉</option>
              <option value="data">数据科学</option>
            </select>
          </div>
          <!-- Graph Filter -->
          <div class="form-control mb-4">
            <label class="label"><span class="label-text">相关图谱</span></label><select id="graphFilter" class="select select-bordered graphFilter spark-custom-graphFilter">
              <option value="">全部图谱</option>
              <option value="tech">技术知识图谱</option>
              <option value="research">研究图谱</option>
              <option value="industry">行业图谱</option>
            </select>
          </div>
          <!-- Date Filter -->
          <div class="form-control mb-4">
            <label class="label"><span class="label-text">日期筛选</span></label>
            <div class="grid grid-cols-2 gap-2">
              <div>
                <label class="label label-text-alt">开始日期</label><input type="date" id="startDateFilter" class="input input-bordered input-sm timeFilter">
              </div>
              <div>
                <label class="label label-text-alt">结束日期</label><input type="date" id="endDateFilter" class="input input-bordered input-sm timeFilter">
              </div>
            </div>
          </div>
          <!-- Sort Options -->
          <div class="form-control mb-6">
            <label class="label"><span class="label-text">排序方式</span></label><select id="sortFilter" class="select select-bordered sortFilter spark-custom-sortFilter">
              <option value="latest">最新发布</option>
              <option value="popular">最多点赞</option>
              <option value="comments">最多评论</option>
              <option value="views">最多浏览</option>
            </select>
          </div>
          <!-- Reset Button --><button class="btn btn-outline w-full" onclick="resetFilters()">
            <span class="iconify" data-icon="heroicons:arrow-path" data-width="16"></span>
            重置筛选
          </button>
        </div>
      </div>
      <!-- Main Content Area -->
      <div class="main-content-wrapper flex-1 flex flex-col">
        <!-- Forum Overview Section -->
        <div class="bg-base-100 border-b academic-border p-6">
          <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
            <!-- Stats Cards -->
            <div class="card bg-gradient-to-r from-primary/10 to-primary/5 border academic-border">
              <div class="card-body p-4 text-center">
                <div class="text-2xl font-bold text-primary">1,234</div>
                <div class="text-sm text-base-content/70">总帖子数</div>
              </div>
            </div>
            <div class="card bg-gradient-to-r from-secondary/10 to-secondary/5 border academic-border">
              <div class="card-body p-4 text-center">
                <div class="text-2xl font-bold text-secondary">5,678</div>
                <div class="text-sm text-base-content/70">总评论数</div>
              </div>
            </div>
            <div class="card bg-gradient-to-r from-accent/10 to-accent/5 border academic-border">
              <div class="card-body p-4 text-center">
                <div class="text-2xl font-bold text-accent">892</div>
                <div class="text-sm text-base-content/70">活跃用户</div>
              </div>
            </div>
            <div class="card bg-gradient-to-r from-info/10 to-info/5 border academic-border">
              <div class="card-body p-4 text-center">
                <div class="text-2xl font-bold text-info">156</div>
                <div class="text-sm text-base-content/70">今日新帖</div>
              </div>
            </div>
          </div>
          <!-- Quick Actions -->
          <div class="flex flex-wrap gap-4 items-center justify-between">
            <div class="flex gap-4">
              <button class="btn btn-primary" onclick="showCreatePostModal()">
                <span class="iconify" data-icon="heroicons:plus" data-width="16"></span>
                发布新帖</button><button class="btn btn-outline">
                <span class="iconify" data-icon="heroicons:fire" data-width="16"></span>
                热门话题
              </button>
            </div>
            <div class="text-sm text-base-content/70">
              <span class="iconify text-success" data-icon="heroicons:signal" data-width="16"></span>
              论坛活跃度: 高
            </div>
          </div>
        </div>
        <!-- Posts List -->
        <div class="flex-1 p-6">
          <div id="postsList" class="space-y-4">
            <!-- Post Item 1 -->
            <div data-repeatable="true" data-type="post" class="card bg-base-100 shadow-soft hover-lift border academic-border">
              <div class="card-body p-6">
                <div class="flex items-start gap-4">
                  <!-- Author Avatar -->
                  <div class="w-12 h-12 rounded-full bg-primary text-primary-content flex items-center justify-center text-sm font-bold">
                    张三
                  </div>
                  <!-- Post Content -->
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                      <h3 class="font-semibold text-base-content">张三</h3>
                      <div class="badge badge-primary badge-sm">AI专家</div>
                      <div class="w-2 h-2 rounded-full bg-success"></div>
                      <span class="text-xs text-base-content/50">在线</span><span class="text-xs text-base-content/50">•</span><span class="text-xs text-base-content/50">2小时前</span>
                    </div>
                    <h4 class="text-lg font-semibold text-primary mb-2 cursor-pointer hover:text-primary/80">
                      深度学习在自然语言处理中的最新进展
                    </h4>
                    <p class="text-base-content/80 mb-3 line-clamp-3">
                      最近在研究Transformer架构的改进方案，发现了一些有趣的优化方法。想和大家分享一下关于注意力机制的新思路，特别是在处理长序列时的效率问题...
                    </p>
                    <!-- Tags -->
                    <div class="flex flex-wrap gap-2 mb-4">
                      <div class="badge badge-outline">深度学习</div>
                      <div class="badge badge-outline">NLP</div>
                      <div class="badge badge-outline">Transformer</div>
                    </div>
                    <!-- Actions -->
                    <div class="flex items-center gap-6">
                      <button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors like-btn" onclick="toggleLike(this)">
                        <span class="iconify" data-icon="heroicons:heart" data-width="16"></span><span>42</span></button><button id="igkiom" class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors igkiom spark-custom-igkiom" onclick="showQuickComment(this)">
                        <span class="iconify" data-icon="heroicons:chat-bubble-left" data-width="16"></span><span>18</span></button><button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors" onclick="openPrivateMessage(&#39;zhang_san&#39;)">
                        <span class="iconify" data-icon="heroicons:envelope" data-width="16"></span><span id="ic631w" class="ic631w spark-custom-ic631w">私信</span></button><button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors" onclick="showShareModal(&#39;post_1&#39;)">
                        <span class="iconify igow27 spark-custom-igow27" data-icon="heroicons:share" data-width="16" id="igow27"></span><span id="iir4zm" class="iir4zm spark-custom-iir4zm">分享</span>
                      </button>
                    </div>
                  </div>
                </div>
                <!-- Comments Section (Initially Hidden) -->
                <div class="comments-section mt-6 pt-4 border-t academic-border hidden">
                  <div class="space-y-4">
                    <!-- Comment Item -->
                    <div data-repeatable="true" data-type="comment" class="flex items-start gap-3">
                      <div class="w-8 h-8 rounded-full bg-secondary text-secondary-content flex items-center justify-center text-xs font-bold">
                        李四
                      </div>
                      <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                          <span class="text-sm font-medium">李四</span><span class="text-xs text-base-content/50">1小时前</span>
                        </div>
                        <p class="text-sm text-base-content/80 mb-2">
                          很有见地的分析！我也在关注这个领域，特别是关于计算效率的优化。
                        </p>
                        <div class="flex items-center gap-4">
                          <button class="flex items-center gap-1 text-xs text-base-content/70 hover:text-primary transition-colors">
                            <span class="iconify" data-icon="heroicons:heart" data-width="12"></span><span>5</span></button><button class="text-xs text-base-content/70 hover:text-primary transition-colors">
                            回复
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Add Comment -->
                  <div class="mt-4 pt-4 border-t academic-border">
                    <div class="flex gap-3">
                      <div class="w-8 h-8 rounded-full bg-accent text-accent-content flex items-center justify-center text-xs font-bold">
                        我
                      </div>
                      <div class="flex-1">
                        <textarea placeholder="写下你的评论..." rows="2" class="textarea textarea-bordered w-full text-sm"></textarea>
                        <div class="flex justify-between items-center mt-2">
                          <div class="flex gap-2">
                            <button class="btn btn-ghost btn-xs">
                              <span class="iconify" data-icon="heroicons:face-smile" data-width="14"></span></button><button class="btn btn-ghost btn-xs">
                              <span class="iconify" data-icon="heroicons:photo" data-width="14"></span>
                            </button>
                          </div>
                          <button class="btn btn-primary btn-sm">
                            发布评论
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Post Item 2 -->
            <div data-repeatable="true" data-type="post" class="card bg-base-100 shadow-soft hover-lift border academic-border">
              <div class="card-body p-6">
                <div class="flex items-start gap-4">
                  <div class="w-12 h-12 rounded-full bg-secondary text-secondary-content flex items-center justify-center text-sm font-bold">
                    王五
                  </div>
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                      <h3 class="font-semibold text-base-content">王五</h3>
                      <div class="badge badge-secondary badge-sm">研究员</div>
                      <div class="w-2 h-2 rounded-full bg-base-300"></div>
                      <span class="text-xs text-base-content/50">离线</span><span class="text-xs text-base-content/50">•</span><span class="text-xs text-base-content/50">5小时前</span>
                    </div>
                    <h4 class="text-lg font-semibold text-primary mb-2 cursor-pointer hover:text-primary/80">
                      知识图谱构建的最佳实践分享
                    </h4>
                    <p class="text-base-content/80 mb-3 line-clamp-3">
                      在构建大规模知识图谱的过程中，遇到了一些技术挑战和解决方案。包括实体识别、关系抽取、图谱存储等方面的经验...
                    </p>
                    <div class="flex flex-wrap gap-2 mb-4">
                      <div class="badge badge-outline">知识图谱</div>
                      <div class="badge badge-outline">实体识别</div>
                      <div class="badge badge-outline">图数据库</div>
                    </div>
                    <div class="flex items-center gap-6">
                      <button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors like-btn" onclick="toggleLike(this)">
                        <span class="iconify" data-icon="heroicons:heart" data-width="16"></span><span>28</span></button><button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors" onclick="showQuickComment(this)">
                        <span class="iconify" data-icon="heroicons:chat-bubble-left" data-width="16"></span><span>12</span></button><button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors" onclick="openPrivateMessage(&#39;wang_wu&#39;)">
                        <span class="iconify" data-icon="heroicons:envelope" data-width="16"></span><span>私信</span></button><button class="flex items-center gap-2 text-base-content/70 hover:text-primary transition-colors" onclick="showShareModal(&#39;post_2&#39;)">
                        <span class="iconify" data-icon="heroicons:share" data-width="16"></span><span>分享</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Load More -->
            <div class="text-center py-8">
              <button class="btn btn-outline" onclick="loadMorePosts()">
                <span class="iconify" data-icon="heroicons:arrow-down" data-width="16"></span>
                加载更多帖子
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- Right Sidebar - Hot Topics -->
      <div class="sidebar-wrapper w-80 bg-base-100 border-l academic-border">
        <div class="p-6">
          <!-- Hot Topics -->
          <div class="mb-8">
            <h2 class="text-lg font-semibold text-base-content mb-4 flex items-center gap-2">
              <span class="iconify text-error" data-icon="heroicons:fire" data-width="20"></span>
              热门话题
            </h2>
            <div class="space-y-3">
              <div class="p-3 rounded-lg bg-base-200 hover:bg-base-300 transition-colors cursor-pointer" onclick="navigateTo(&#39;page_998125&#39;)">
                <div class="flex items-center justify-between mb-1">
                  <span class="font-medium text-sm">AI大模型发展趋势</span>
                  <div class="badge badge-error badge-xs">热</div>
                </div>
                <div class="text-xs text-base-content/70">
                  1.2k 讨论 • 3.5k 浏览
                </div>
              </div>
              <div class="p-3 rounded-lg bg-base-200 hover:bg-base-300 transition-colors cursor-pointer" onclick="navigateTo(&#39;page_998125&#39;)">
                <div class="flex items-center justify-between mb-1">
                  <span class="font-medium text-sm">图神经网络应用</span>
                  <div class="badge badge-warning badge-xs">新</div>
                </div>
                <div class="text-xs text-base-content/70">
                  856 讨论 • 2.1k 浏览
                </div>
              </div>
              <div class="p-3 rounded-lg bg-base-200 hover:bg-base-300 transition-colors cursor-pointer" onclick="navigateTo(&#39;page_998125&#39;)">
                <div class="flex items-center justify-between mb-1">
                  <span class="font-medium text-sm">多模态学习研究</span>
                </div>
                <div class="text-xs text-base-content/70">
                  642 讨论 • 1.8k 浏览
                </div>
              </div>
            </div>
          </div>
          <!-- Announcements -->
          <div class="mb-8">
            <h2 class="text-lg font-semibold text-base-content mb-4 flex items-center gap-2">
              <span class="iconify text-info" data-icon="heroicons:megaphone" data-width="20"></span>
              论坛公告
            </h2>
            <div class="space-y-3">
              <div class="alert alert-info p-3">
                <span class="iconify" data-icon="heroicons:information-circle" data-width="16"></span>
                <div class="text-sm">
                  <div class="font-medium">论坛升级通知</div>
                  <div class="text-xs opacity-70">
                    系统将于本周末进行维护升级
                  </div>
                </div>
              </div>
              <div class="alert alert-success p-3">
                <span class="iconify" data-icon="heroicons:gift" data-width="16"></span>
                <div class="text-sm">
                  <div class="font-medium">新功能上线</div>
                  <div class="text-xs opacity-70">支持图片和视频上传功能</div>
                </div>
              </div>
            </div>
          </div>
          <!-- Related Graphs -->
          <div>
            <h2 class="text-lg font-semibold text-base-content mb-4 flex items-center gap-2">
              <span class="iconify text-accent" data-icon="heroicons:squares-2x2" data-width="20"></span>
              相关图谱
            </h2>
            <div class="space-y-3">
              <div class="card bg-base-200 hover:bg-base-300 transition-colors cursor-pointer" onclick="navigateTo(&#39;graph_detail_page&#39;)">
                <div class="card-body p-3">
                  <div class="flex items-center gap-3">
                    <img alt="AI知识图谱" class="w-10 h-10 rounded" data-src="placehold.co/40x40.png?text=AI">
                    <div class="flex-1">
                      <div class="font-medium text-sm">AI技术图谱</div>
                      <div class="text-xs text-base-content/70">1.2k 节点</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card bg-base-200 hover:bg-base-300 transition-colors cursor-pointer" onclick="navigateTo(&#39;graph_detail_page&#39;)">
                <div class="card-body p-3">
                  <div class="flex items-center gap-3">
                    <img alt="机器学习图谱" class="w-10 h-10 rounded" data-src="placehold.co/40x40.png?text=ML">
                    <div class="flex-1">
                      <div class="font-medium text-sm">机器学习图谱</div>
                      <div class="text-xs text-base-content/70">856 节点</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Create Post Modal -->
    <dialog id="createPostModal" class="modal">
      <div class="modal-box w-11/12 max-w-2xl">
        <h3 class="font-bold text-lg mb-4">发布新帖</h3>
        <div class="space-y-4">
          <div class="form-control">
            <label class="label"><span class="label-text">帖子标题</span></label><input type="text" placeholder="输入帖子标题..." class="input input-bordered">
          </div>
          <div class="form-control">
            <label class="label"><span class="label-text">选择领域</span></label><select class="select select-bordered">
              <option value="">选择相关领域</option>
              <option value="ai">人工智能</option>
              <option value="ml">机器学习</option>
              <option value="nlp">自然语言处理</option>
              <option value="cv">计算机视觉</option>
            </select>
          </div>
          <div class="form-control">
            <label class="label"><span class="label-text">帖子内容</span></label><textarea placeholder="分享你的想法和见解..." class="textarea textarea-bordered h-32"></textarea>
          </div>
          <div class="form-control">
            <label class="label"><span class="label-text">标签</span></label><input type="text" placeholder="添加标签，用逗号分隔..." class="input input-bordered">
          </div>
        </div>
        <div class="modal-action">
          <button class="btn btn-ghost" onclick="closeCreatePostModal()">
            取消</button><button class="btn btn-primary" onclick="submitPost()">
            发布帖子
          </button>
        </div>
      </div>
      <form method="dialog" class="modal-backdrop"><button>close</button></form>
    </dialog>
    <!-- Private Message Modal -->
    <dialog id="privateMessageModal" class="modal">
      <div class="modal-box w-96 max-w-sm">
        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
          <span class="iconify text-primary" data-icon="heroicons:envelope" data-width="20"></span>
          发送私信
        </h3>
        <div class="space-y-4">
          <div class="form-control">
            <label class="label"><span class="label-text">收件人</span></label><input type="text" id="recipientName" placeholder="用户名" readonly="" class="input input-bordered input-sm">
          </div>
          <div class="form-control">
            <label class="label"><span class="label-text">消息内容</span></label><textarea id="messageContent" placeholder="输入你的消息..." maxlength="500" class="textarea textarea-bordered h-24 text-sm"></textarea><label class="label"><span class="label-text-alt text-base-content/50"><span id="charCount">0</span>/500
              </span></label>
          </div>
        </div>
        <div class="modal-action">
          <button class="btn btn-ghost btn-sm" onclick="closePrivateMessageModal()">
            取消</button><button class="btn btn-primary btn-sm" onclick="sendPrivateMessage()">
            <span class="iconify" data-icon="heroicons:paper-airplane" data-width="16"></span>
            发送
          </button>
        </div>
      </div>
      <form method="dialog" class="modal-backdrop"><button>close</button></form>
    </dialog>
    <!-- Quick Comment Modal -->
    <dialog id="quickCommentModal" class="modal">
      <div class="modal-box w-96 max-w-sm">
        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
          <span class="iconify text-primary" data-icon="heroicons:chat-bubble-left" data-width="20"></span>
          快速评论
        </h3>
        <div class="space-y-4">
          <div class="form-control">
            <label class="label"><span class="label-text">评论内容</span></label><textarea id="quickCommentContent" placeholder="写下你的评论..." maxlength="300" class="textarea textarea-bordered h-20 text-sm"></textarea><label class="label"><span class="label-text-alt text-base-content/50"><span id="quickCommentCharCount">0</span>/300
              </span></label>
          </div>
        </div>
        <div class="modal-action">
          <button class="btn btn-ghost btn-sm" onclick="closeQuickCommentModal()">
            取消</button><button class="btn btn-primary btn-sm" onclick="submitQuickComment()">
            <span class="iconify" data-icon="heroicons:paper-airplane" data-width="16"></span>
            发布评论
          </button>
        </div>
      </div>
      <form method="dialog" class="modal-backdrop"><button>close</button></form>
    </dialog>
    <!-- Share Modal -->
    <dialog id="shareModal" class="modal">
      <div class="modal-box w-96 max-w-sm">
        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
          <span class="iconify text-primary" data-icon="heroicons:share" data-width="20"></span>
          分享帖子
        </h3>
        <div class="space-y-4">
          <div class="form-control">
            <label class="label"><span class="label-text">分享链接</span></label>
            <div class="join">
              <input type="text" id="shareLink" readonly="" value="" class="input input-bordered join-item flex-1 text-sm"><button id="copyButton" class="btn btn-primary join-item" onclick="copyShareLink()">
                <span class="iconify" data-icon="heroicons:clipboard-document" data-width="16"></span>
                复制
              </button>
            </div>
          </div>
          <div class="divider text-xs">或通过以下方式分享</div>
          <div class="flex gap-2 justify-center">
            <button class="btn btn-outline btn-sm" onclick="shareToWeChat()">
              <span class="iconify text-green-500" data-icon="heroicons:chat-bubble-left-ellipsis" data-width="16"></span>
              微信</button><button class="btn btn-outline btn-sm" onclick="shareToWeibo()">
              <span class="iconify text-red-500" data-icon="heroicons:megaphone" data-width="16"></span>
              微博</button><button class="btn btn-outline btn-sm" onclick="shareToQQ()">
              <span class="iconify text-blue-500" data-icon="heroicons:chat-bubble-oval-left" data-width="16"></span>
              QQ
            </button>
          </div>
        </div>
        <div class="modal-action">
          <button class="btn btn-ghost btn-sm" onclick="closeShareModal()">
            关闭
          </button>
        </div>
      </div>
      <form method="dialog" class="modal-backdrop"><button>close</button></form>
    </dialog>
    <!-- Footer -->
    <div class="footer-wrapper"><div data-section-id="common_footer" data-section-type="common_footer">
<footer class="footer footer-center p-6 bg-base-200 text-base-content border-t academic-border">
<div class="grid grid-flow-col gap-4">
<a onclick="navigateTo(&#39;about_page&#39;)" class="link link-hover focus-primary">关于我们</a>
<a onclick="navigateTo(&#39;documentation_page&#39;)" class="link link-hover focus-primary">帮助中心</a>
<a onclick="navigateTo(&#39;feedback_page&#39;)" class="link link-hover focus-primary">用户反馈</a>
<a class="link link-hover focus-primary">隐私政策</a>
<a class="link link-hover focus-primary">服务条款</a>
</div>
<div class="grid grid-flow-col gap-4">
<a class="link link-hover focus-primary" aria-label="官方微信">
<span class="iconify" data-icon="simple-icons:wechat" data-width="20" style="color: var(--color-success);"></span>
</a>
<a class="link link-hover focus-primary" aria-label="企业QQ">
<span class="iconify" data-icon="simple-icons:tencentqq" data-width="20" style="color: var(--color-primary);"></span>
</a>
<a onclick="navigateTo(&#39;feedback_page&#39;)" class="link link-hover focus-primary" aria-label="意见反馈">
<span class="iconify" data-icon="heroicons:chat-bubble-left-right" data-width="20"></span>
</a>
</div>
<div class="text-center">
<p>© 2025 Graph+知识图谱平台. 版权所有 | <span class="text-primary font-medium">智慧知识发现与探索</span></p>
<p class="text-xs opacity-70 mt-1">反馈邮箱: feedback@knowledgegraph.com</p>
</div>
</footer>
</div></div>
    <script>
(function() {
&#39;use strict&#39;;

// Initialize global namespace
window.APP_GLOBALS = window.APP_GLOBALS || {};

// Global navigation utility
window.navigateTo = function(targetPageId) {
const isInIframe = window.self !== window.top;
const targetFileName = `${targetPageId}.html`;

if (isInIframe) {
window.parent.postMessage({
type: &#39;iframeNavigation&#39;,
targetPageId: targetPageId
}, &#39;*&#39;);
} else {
window.location.href = targetFileName;
}
};

// User authentication state management
window.APP_GLOBALS.user = {
isLoggedIn: false,
userInfo: null,

login: function(userInfo) {
this.isLoggedIn = true;
this.userInfo = userInfo;
localStorage.setItem(&#39;userState&#39;, JSON.stringify({
isLoggedIn: true,
userInfo: userInfo
}));
this.updateUserInterface();
},

logout: function() {
this.isLoggedIn = false;
this.userInfo = null;
localStorage.removeItem(&#39;userState&#39;);
this.updateUserInterface();
navigateTo(&#39;home_page&#39;);
},

updateUserInterface: function() {
const userControls = document.querySelectorAll(&#39;[data-user-control]&#39;);
userControls.forEach(control => {
const controlType = control.getAttribute(&#39;data-user-control&#39;);
if (controlType === &#39;logged-out&#39; &amp;&amp; this.isLoggedIn) {
control.style.display = &#39;none&#39;;
} else if (controlType === &#39;logged-in&#39; &amp;&amp; !this.isLoggedIn) {
control.style.display = &#39;none&#39;;
} else {
control.style.display = &#39;&#39;;
}
});
},

init: function() {
const savedState = localStorage.getItem(&#39;userState&#39;);
if (savedState) {
const state = JSON.parse(savedState);
this.isLoggedIn = state.isLoggedIn;
this.userInfo = state.userInfo;
}
this.updateUserInterface();
}
};

// Search functionality
window.APP_GLOBALS.search = {
history: JSON.parse(localStorage.getItem(&#39;searchHistory&#39;) || &#39;[]&#39;),
recommendations: [&#39;人工智能&#39;, &#39;机器学习&#39;, &#39;自然语言处理&#39;, &#39;计算机视觉&#39;, &#39;深度学习&#39;],

addToHistory: function(query) {
if (query &amp;&amp; !this.history.includes(query)) {
this.history.unshift(query);
this.history = this.history.slice(0, 10); // Keep only last 10 searches
localStorage.setItem(&#39;searchHistory&#39;, JSON.stringify(this.history));
}
},

getSearchSuggestions: function() {
return this.history.length > 0 ? this.history : this.recommendations;
},

performSearch: function(query, targetPage = &#39;graph_list_page&#39;) {
this.addToHistory(query);
// Navigate to search results or graph detail based on context
navigateTo(targetPage);
}
};

// Notification utilities
window.showNotification = function(message, type = &#39;info&#39;) {
const notification = document.createElement(&#39;div&#39;);
notification.className = `alert alert-${type} fixed top-4 right-4 w-96 z-50 shadow-lg`;
notification.innerHTML = `
<div class="flex items-center gap-2">
<span class="iconify" data-icon="heroicons:information-circle-solid" data-width="20"></span>
<span>${message}</span>
</div>
`;
document.body.appendChild(notification);

setTimeout(() => {
notification.remove();
}, 5000);
};

// Favorites management
window.APP_GLOBALS.favorites = {
items: JSON.parse(localStorage.getItem(&#39;favorites&#39;) || &#39;[]&#39;),

add: function(graphId, graphData) {
if (!this.items.find(item => item.id === graphId)) {
this.items.push({
id: graphId,
data: graphData,
addedAt: new Date().toISOString()
});
localStorage.setItem(&#39;favorites&#39;, JSON.stringify(this.items));
showNotification(&#39;已添加到收藏&#39;, &#39;success&#39;);
}
},

remove: function(graphId) {
this.items = this.items.filter(item => item.id !== graphId);
localStorage.setItem(&#39;favorites&#39;, JSON.stringify(this.items));
showNotification(&#39;已从收藏中移除&#39;, &#39;info&#39;);
},

isFavorited: function(graphId) {
return this.items.some(item => item.id === graphId);
},

toggle: function(graphId, graphData) {
if (this.isFavorited(graphId)) {
this.remove(graphId);
} else {
this.add(graphId, graphData);
}
}
};

// Initialize components when DOM is loaded
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
window.APP_GLOBALS.user.init();
});

})();
</script><script>
// Forum functionality
function performSearch() {
    const searchInput = document.getElementById(&#39;searchInput&#39;);
    const query = searchInput.value.trim();
    
    if (query) {
        showNotification(`正在搜索: ${query}`, &#39;info&#39;);
        // Simulate search functionality
        setTimeout(() => {
            showNotification(&#39;搜索完成&#39;, &#39;success&#39;);
        }, 1000);
    }
}

function resetFilters() {
    document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;
    document.getElementById(&#39;contentFilter&#39;).value = &#39;&#39;;
    document.getElementById(&#39;domainFilter&#39;).value = &#39;&#39;;
    document.getElementById(&#39;graphFilter&#39;).value = &#39;&#39;;
    document.getElementById(&#39;startDateFilter&#39;).value = &#39;&#39;;
    document.getElementById(&#39;endDateFilter&#39;).value = &#39;&#39;;
    document.getElementById(&#39;sortFilter&#39;).value = &#39;latest&#39;;
    
    showNotification(&#39;筛选条件已重置&#39;, &#39;info&#39;);
}

function toggleLike(button) {
    const isLiked = button.classList.contains(&#39;liked&#39;);
    const countSpan = button.querySelector(&#39;span:last-child&#39;);
    let count = parseInt(countSpan.textContent);
    
    if (isLiked) {
        button.classList.remove(&#39;liked&#39;);
        count--;
        button.querySelector(&#39;.iconify&#39;).style.color = &#39;&#39;;
    } else {
        button.classList.add(&#39;liked&#39;);
        count++;
        button.querySelector(&#39;.iconify&#39;).style.color = &#39;var(--color-error)&#39;;
        
        // Trigger animation
        button.querySelector(&#39;.iconify&#39;).style.animation = &#39;likeAnimation 0.3s ease-in-out&#39;;
        setTimeout(() => {
            button.querySelector(&#39;.iconify&#39;).style.animation = &#39;&#39;;
        }, 300);
    }
    
    countSpan.textContent = count;
}

function toggleComments(button) {
    const postCard = button.closest(&#39;.card&#39;);
    const commentsSection = postCard.querySelector(&#39;.comments-section&#39;);
    
    if (commentsSection.classList.contains(&#39;hidden&#39;)) {
        commentsSection.classList.remove(&#39;hidden&#39;);
        button.querySelector(&#39;span:last-child&#39;).textContent = parseInt(button.querySelector(&#39;span:last-child&#39;).textContent);
    } else {
        commentsSection.classList.add(&#39;hidden&#39;);
    }
}

function showQuickComment(button) {
    // Store reference to the comment button for later use
    window.currentCommentButton = button;
    
    // Clear previous content
    const commentContent = document.getElementById(&#39;quickCommentContent&#39;);
    const charCount = document.getElementById(&#39;quickCommentCharCount&#39;);
    
    commentContent.value = &#39;&#39;;
    charCount.textContent = &#39;0&#39;;
    
    // Show the modal
    document.getElementById(&#39;quickCommentModal&#39;).showModal();
    
    // Focus on comment content
    setTimeout(() => {
        commentContent.focus();
    }, 100);
}

function closeQuickCommentModal() {
    document.getElementById(&#39;quickCommentModal&#39;).close();
    window.currentCommentButton = null;
}

function submitQuickComment() {
    const commentContent = document.getElementById(&#39;quickCommentContent&#39;).value.trim();
    
    if (!commentContent) {
        showNotification(&#39;请输入评论内容&#39;, &#39;warning&#39;);
        return;
    }
    
    if (commentContent.length > 300) {
        showNotification(&#39;评论内容不能超过300字符&#39;, &#39;warning&#39;);
        return;
    }
    
    // Update comment count on the button
    if (window.currentCommentButton) {
        const countSpan = window.currentCommentButton.querySelector(&#39;span:last-child&#39;);
        let count = parseInt(countSpan.textContent);
        count++;
        countSpan.textContent = count;
    }
    
    // Simulate posting comment
    showNotification(&#39;评论发布成功！&#39;, &#39;success&#39;);
    closeQuickCommentModal();
    
    // Clear the form
    document.getElementById(&#39;quickCommentContent&#39;).value = &#39;&#39;;
    document.getElementById(&#39;quickCommentCharCount&#39;).textContent = &#39;0&#39;;
}

function openPrivateMessage(userId) {
    // Set recipient name in the modal
    const recipientInput = document.getElementById(&#39;recipientName&#39;);
    const messageContent = document.getElementById(&#39;messageContent&#39;);
    const charCount = document.getElementById(&#39;charCount&#39;);
    
    // Convert userId to display name (you can customize this mapping)
    const userDisplayNames = {
        &#39;zhang_san&#39;: &#39;张三&#39;,
        &#39;wang_wu&#39;: &#39;王五&#39;,
        &#39;li_si&#39;: &#39;李四&#39;
    };
    
    recipientInput.value = userDisplayNames[userId] || userId;
    messageContent.value = &#39;&#39;;
    charCount.textContent = &#39;0&#39;;
    
    // Show the modal
    document.getElementById(&#39;privateMessageModal&#39;).showModal();
    
    // Focus on message content
    setTimeout(() => {
        messageContent.focus();
    }, 100);
}

function closePrivateMessageModal() {
    document.getElementById(&#39;privateMessageModal&#39;).close();
}

function sendPrivateMessage() {
    const recipientName = document.getElementById(&#39;recipientName&#39;).value;
    const messageContent = document.getElementById(&#39;messageContent&#39;).value.trim();
    
    if (!messageContent) {
        showNotification(&#39;请输入消息内容&#39;, &#39;warning&#39;);
        return;
    }
    
    if (messageContent.length > 500) {
        showNotification(&#39;消息内容不能超过500字符&#39;, &#39;warning&#39;);
        return;
    }
    
    // Simulate sending message
    showNotification(`私信已发送给 ${recipientName}`, &#39;success&#39;);
    closePrivateMessageModal();
    
    // Clear the form
    document.getElementById(&#39;messageContent&#39;).value = &#39;&#39;;
    document.getElementById(&#39;charCount&#39;).textContent = &#39;0&#39;;
}

function showCreatePostModal() {
    document.getElementById(&#39;createPostModal&#39;).showModal();
}

function closeCreatePostModal() {
    document.getElementById(&#39;createPostModal&#39;).close();
}

function submitPost() {
    const title = document.querySelector(&#39;#createPostModal input[type="text"]&#39;).value;
    const content = document.querySelector(&#39;#createPostModal textarea&#39;).value;
    
    if (title.trim() &amp;&amp; content.trim()) {
        showNotification(&#39;帖子发布成功！&#39;, &#39;success&#39;);
        closeCreatePostModal();
        
        // Clear form
        document.querySelector(&#39;#createPostModal input[type="text"]&#39;).value = &#39;&#39;;
        document.querySelector(&#39;#createPostModal textarea&#39;).value = &#39;&#39;;
        document.querySelector(&#39;#createPostModal select&#39;).value = &#39;&#39;;
        document.querySelector(&#39;#createPostModal input[placeholder*="标签"]&#39;).value = &#39;&#39;;
    } else {
        showNotification(&#39;请填写标题和内容&#39;, &#39;warning&#39;);
    }
}

function loadMorePosts() {
    const postsList = document.getElementById(&#39;postsList&#39;);
    const loadButton = event.target;
    
    // Show loading state
    loadButton.innerHTML = &#39;<span class="loading loading-spinner loading-sm"></span> 加载中...&#39;;
    loadButton.disabled = true;
    
    // Simulate loading
    setTimeout(() => {
        showNotification(&#39;已加载更多帖子&#39;, &#39;success&#39;);
        loadButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:arrow-down" data-width="16"></span> 加载更多帖子&#39;;
        loadButton.disabled = false;
    }, 1500);
}

// Initialize forum features
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
    // Add search functionality on Enter key
    document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;keypress&#39;, function(e) {
        if (e.key === &#39;Enter&#39;) {
            performSearch();
        }
    });
    
    // Add character counter for private message
    const messageContent = document.getElementById(&#39;messageContent&#39;);
    const charCount = document.getElementById(&#39;charCount&#39;);
    
    if (messageContent &amp;&amp; charCount) {
        messageContent.addEventListener(&#39;input&#39;, function() {
            const currentLength = this.value.length;
            charCount.textContent = currentLength;
            
            // Change color when approaching limit
            if (currentLength > 450) {
                charCount.style.color = &#39;var(--color-error)&#39;;
            } else if (currentLength > 400) {
                charCount.style.color = &#39;var(--color-warning)&#39;;
            } else {
                charCount.style.color = &#39;&#39;;
            }
        });
        
        // Add Enter key support for sending (Ctrl+Enter)
        messageContent.addEventListener(&#39;keydown&#39;, function(e) {
            if (e.key === &#39;Enter&#39; &amp;&amp; e.ctrlKey) {
                e.preventDefault();
                sendPrivateMessage();
            }
        });
}
    
    // Add character counter for quick comment
    const quickCommentContent = document.getElementById(&#39;quickCommentContent&#39;);
    const quickCommentCharCount = document.getElementById(&#39;quickCommentCharCount&#39;);
    
    if (quickCommentContent &amp;&amp; quickCommentCharCount) {
        quickCommentContent.addEventListener(&#39;input&#39;, function() {
            const currentLength = this.value.length;
            quickCommentCharCount.textContent = currentLength;
            
            // Change color when approaching limit
            if (currentLength > 270) {
                quickCommentCharCount.style.color = &#39;var(--color-error)&#39;;
            } else if (currentLength > 240) {
                quickCommentCharCount.style.color = &#39;var(--color-warning)&#39;;
            } else {
                quickCommentCharCount.style.color = &#39;&#39;;
            }
        });
        
        // Add Enter key support for submitting (Ctrl+Enter)
        quickCommentContent.addEventListener(&#39;keydown&#39;, function(e) {
            if (e.key === &#39;Enter&#39; &amp;&amp; e.ctrlKey) {
                e.preventDefault();
                submitQuickComment();
            }
        });
    }
    
// Add filter change listeners
    const filters = [&#39;contentFilter&#39;, &#39;domainFilter&#39;, &#39;graphFilter&#39;, &#39;startDateFilter&#39;, &#39;endDateFilter&#39;, &#39;sortFilter&#39;];
    filters.forEach(filterId => {
        const element = document.getElementById(filterId);
        if (element) {
            const eventType = element.type === &#39;date&#39; || element.type === &#39;text&#39; ? &#39;input&#39; : &#39;change&#39;;
            element.addEventListener(eventType, function() {
                showNotification(&#39;筛选条件已更新&#39;, &#39;info&#39;);
            });
        }
    });
    
    // Initialize intersection observer for infinite scroll
    const loadMoreButton = document.querySelector(&#39;button[onclick="loadMorePosts()"]&#39;);
    if (loadMoreButton) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting &amp;&amp; !entry.target.disabled) {
                    // Auto-load when button comes into view (optional)
                    // loadMorePosts();
                }
            });
        }, { threshold: 0.1 });
        
        observer.observe(loadMoreButton);
    }
});

// Utility functions for forum interactions
function addComment(postId, content) {
    if (content.trim()) {
        showNotification(&#39;评论发布成功&#39;, &#39;success&#39;);
        return true;
    }
    return false;
}

function sharePost(postId) {
    if (navigator.share) {
        navigator.share({
            title: &#39;分享帖子&#39;,
            text: &#39;来看看这个有趣的讨论&#39;,
            url: window.location.href
        });
    } else {
        // Fallback for browsers without Web Share API
        navigator.clipboard.writeText(window.location.href).then(() => {
            showNotification(&#39;链接已复制到剪贴板&#39;, &#39;success&#39;);
        });
    }
}

function reportPost(postId) {
    showNotification(&#39;举报已提交，我们会尽快处理&#39;, &#39;info&#39;);
}

// Share functionality
function showShareModal(postId) {
    // Generate share link based on post ID
    const baseUrl = window.location.origin + window.location.pathname;
    const shareUrl = `${baseUrl}?post=${postId}`;
    
    // Set the share link in the modal
    document.getElementById(&#39;shareLink&#39;).value = shareUrl;
    
    // Store current post ID for sharing
    window.currentSharePostId = postId;
    
    // Reset copy button state
    const copyButton = document.getElementById(&#39;copyButton&#39;);
    copyButton.classList.remove(&#39;copied&#39;);
    copyButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:clipboard-document" data-width="16"></span> 复制&#39;;
    
    // Show the modal
    document.getElementById(&#39;shareModal&#39;).showModal();
}

function closeShareModal() {
    document.getElementById(&#39;shareModal&#39;).close();
    window.currentSharePostId = null;
}

function copyShareLink() {
    const shareLink = document.getElementById(&#39;shareLink&#39;);
    const copyButton = document.getElementById(&#39;copyButton&#39;);
    
    // Copy to clipboard
    navigator.clipboard.writeText(shareLink.value).then(() => {
        // Update button appearance
        copyButton.classList.add(&#39;copied&#39;);
        copyButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:check" data-width="16"></span> 已复制&#39;;
        
        // Show success notification
        showNotification(&#39;链接已复制到剪贴板&#39;, &#39;success&#39;);
        
        // Reset button after 2 seconds
        setTimeout(() => {
            copyButton.classList.remove(&#39;copied&#39;);
            copyButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:clipboard-document" data-width="16"></span> 复制&#39;;
        }, 2000);
    }).catch(() => {
        // Fallback for older browsers
        shareLink.select();
        shareLink.setSelectionRange(0, 99999);
        document.execCommand(&#39;copy&#39;);
        
        showNotification(&#39;链接已复制到剪贴板&#39;, &#39;success&#39;);
        
        // Update button appearance
        copyButton.classList.add(&#39;copied&#39;);
        copyButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:check" data-width="16"></span> 已复制&#39;;
        
        setTimeout(() => {
            copyButton.classList.remove(&#39;copied&#39;);
            copyButton.innerHTML = &#39;<span class="iconify" data-icon="heroicons:clipboard-document" data-width="16"></span> 复制&#39;;
        }, 2000);
    });
}

function shareToWeChat() {
    const shareLink = document.getElementById(&#39;shareLink&#39;).value;
    const postTitle = getPostTitle(window.currentSharePostId);
    
    // For WeChat sharing, we would typically use WeChat SDK
    // Here we&#39;ll show a notification with instructions
    showNotification(&#39;请复制链接后在微信中分享&#39;, &#39;info&#39;);
    copyShareLink();
}

function shareToWeibo() {
    const shareLink = document.getElementById(&#39;shareLink&#39;).value;
    const postTitle = getPostTitle(window.currentSharePostId);
    const weiboUrl = `https://service.weibo.com/share/share.php?url=${encodeURIComponent(shareLink)}&amp;title=${encodeURIComponent(postTitle)}&amp;pic=&amp;appkey=`;
    
    window.open(weiboUrl, &#39;_blank&#39;, &#39;width=600,height=400&#39;);
    showNotification(&#39;正在打开微博分享页面&#39;, &#39;info&#39;);
}

function shareToQQ() {
    const shareLink = document.getElementById(&#39;shareLink&#39;).value;
    const postTitle = getPostTitle(window.currentSharePostId);
    const qqUrl = `https://connect.qq.com/widget/shareqq/index.html?url=${encodeURIComponent(shareLink)}&amp;title=${encodeURIComponent(postTitle)}&amp;source=知识图谱论坛`;
    
    window.open(qqUrl, &#39;_blank&#39;, &#39;width=600,height=400&#39;);
    showNotification(&#39;正在打开QQ分享页面&#39;, &#39;info&#39;);
}

function getPostTitle(postId) {
    // Get post title based on post ID
    // This is a simplified implementation
    const postTitles = {
        &#39;post_1&#39;: &#39;深度学习在自然语言处理中的最新进展&#39;,
        &#39;post_2&#39;: &#39;知识图谱构建的最佳实践分享&#39;
    };
    
    return postTitles[postId] || &#39;知识图谱论坛 - 精彩讨论&#39;;
}

// Update the existing sharePost function to use the new modal
function sharePost(postId) {
    showShareModal(postId);
}
</script>
  

<script>
    setTimeout(() => {
      Holder.run({
        domain: "placehold.co"
      })
    }, 100)
  </script></body></html>'></iframe>
                    </div>
                  </div>

                </body>
                </html>
            