
                <!DOCTYPE html>
                <html lang="zh">
                <head>
                  <meta charset="UTF-8">
                  <meta name="viewport" content="width=device-width, initial-scale=1.0">
                  <title>图谱列表页</title>
                  <style>
                    *,
                    *::before,
                    *::after {
                      box-sizing: border-box;
                      margin: 0;
                    }
                    .iframe-outer {
                      position: fixed;
                      top: 0;
                      left: 0;
                      bottom: 0;
                      right: 0;
                      display: flex;
                      justify-content: center;
                      background-color: #E0E0E0;
                    }
                    .iframe-wrapper {
                      width: 100%;
                      height: 100%;
                      margin: 0 auto;
                      transform-origin: center top;
                      flex-shrink: 0;
                    }
                    #dynamicIframe {
                      border: none;
                      width: 100%;
                      height: 100%;
                    }
                  </style>
                  <script>
                const width = 1920
                const height = 1080
                const resolutionRatio = width && height ? width / height : 1
                const pageNameMap = {
                  'home_page': '首页',
    'login_register_page': '登录/注册',
    'registration_success_page': '注册成功',
    'password_reset_page': '找回密码',
    'graph_list_page': '图谱列表页',
    'graph_detail_page': '图谱详情页',
    'user_profile_page': '个人中心',
    'documentation_page': '文档',
    'about_page': '关于我们',
    'feedback_page': '用户反馈',
    'page_998124': '管理',
    'page_998125': '论坛'
                }
                function setIframeSize(w, h) {
                  const currentContainerRadio = w / h
                  let widthValue = w
                  let heightValue = h
                  let zoom = 1
                  if (currentContainerRadio > resolutionRatio) {
                    widthValue = h * resolutionRatio
                    heightValue = h
                  } else {
                    widthValue = w
                    heightValue = w / resolutionRatio
                  }
                  zoom = width ? widthValue / width : 1
                  return {
                    width: widthValue / zoom + 'px',
                    height: heightValue / zoom + 'px',
                    zoom,
                  }
                }
                function adjustIframeSize() {
                  const iframeWrapper = document.querySelector(".iframe-wrapper")
                  if (!iframeWrapper) return
                  iframeWrapper.style.width = '100%'
                  iframeWrapper.style.height = window.innerHeight + 'px'
                  iframeWrapper.style.transform = ''
                }
                function sanitizeFilename(name) {
                  return name.replace(/[\/:*?"<>|]/g, '_')
                }
                function handlePostMessage(event) {
                  if (!event.data) {
                    return
                  }
                  const { type, targetPageId, params } = event.data
                  const pagePathMap = {
                    'home_page': './home.html',
                    'login_register_page': '../user/login_register.html',
                    'registration_success_page': '../user/registration_success.html',
                    'password_reset_page': '../user/password_reset.html',
                    'graph_list_page': './graph_list.html',
                    'graph_detail_page': './graph_detail.html',
                    'user_profile_page': '../user/profile.html',
                    'documentation_page': '../pages/documentation.html',
                    'about_page': '../pages/about.html',
                    'feedback_page': '../community/feedback.html',
                    'page_998124': '../admin/dashboard.html',
                    'page_998125': '../community/forum_list.html'
                  };
                  let targetPath = pagePathMap[targetPageId];
                  if (type === "iframeNavigation" && targetPath) {
                    // 如果有 params，拼接到 URL 上
                    if (params && params.graphId) {
                      targetPath += '?id=' + params.graphId;
                    }
                    window.location.href = targetPath
                  }
                }
                window.addEventListener('message', handlePostMessage)
                window.onload = adjustIframeSize
                window.onresize = adjustIframeSize
                window.onunload = () => {
                  window.removeEventListener('message', handlePostMessage)
                }
              </script>
                </head>
                <body>
                  <div class="iframe-outer">
                    <div class="iframe-wrapper">
                      <iframe id="dynamicIframe" srcdoc='<html lang="zh" data-theme="corporate"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>知识图谱探索 - Graph+知识图谱平台</title>
    <link href="/assets/static/libs/daisyui@5.css" rel="stylesheet" type="text/css">
    <script src="/assets/static/libs/tailwind-browser@4.js"></script>
    <link href="/assets/static/libs/daisyui-themes.css" rel="stylesheet" type="text/css">
    <script src="/assets/3/3.1.1/iconify.min.js"></script>
    <style>
/* daisyUI Theme Variables Customization
* Based on the selected daisyUI theme and UI guidance requirements,
* customize only the CSS variables that need to be different from the theme defaults.
*/
:root {
/* Corporate theme customization for knowledge graph platform */
--color-primary: rgba(30, 58, 138, 1); /* Deep Blue #1E3A8A - 学院风深蓝 */
--color-primary-content: rgba(255, 255, 255, 1);
--color-secondary: rgba(37, 99, 235, 1); /* Medium Blue #2563EB */
--color-secondary-content: rgba(255, 255, 255, 1);
--color-accent: rgba(16, 185, 129, 1); /* Emerald Green #10B981 */
--color-accent-content: rgba(255, 255, 255, 1);
--color-base-100: rgba(255, 255, 255, 1);
--color-base-200: rgba(247, 249, 250, 1); /* #F7F9FA */
--color-base-300: rgba(229, 231, 235, 1); /* #E5E7EB */
--color-base-content: rgba(55, 65, 81, 1); /* #374151 */
--color-success: rgba(16, 185, 129, 1);
--color-warning: rgba(245, 158, 11, 1);
--color-error: rgba(239, 68, 68, 1);
--color-info: rgba(59, 130, 246, 1);
--radius-box: 0.375rem; /* 6px for micro-rounded corners */
--radius-field: 0.375rem;
--border: 1px;
}

/* Global component styles */
.transition-width {
transition: width 0.3s ease-in-out;
}

.nav-hover {
transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out;
}

.shadow-soft {
box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

/* Header height consistency */
.header-height {
height: 64px;
}

/* Focus styles for accessibility */
.focus-primary:focus {
outline: 2px solid var(--color-primary);
outline-offset: 2px;
}

/* Academic style enhancements */
.academic-border {
border: var(--border) solid var(--color-base-300);
}

.hover-lift {
transition: transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.hover-lift:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Professional grid spacing */
.academic-grid {
gap: 1.5rem;
}

/* Clean divider lines */
.academic-divider {
border-color: var(--color-base-300);
border-width: var(--border);
}
</style> <style>
/* 图谱列表页专用样式 */
.filter-btn.active {
  background-color: var(--color-primary);
  color: var(--color-primary-content);
}

.filter-btn {
  transition: all 0.15s ease-in-out;
}

.filter-btn:hover:not(.active) {
  background-color: var(--color-base-200);
}

.view-toggle.active {
  background-color: var(--color-primary);
  color: var(--color-primary-content);
}

.view-toggle {
  transition: all 0.15s ease-in-out;
}

.graph-card {
  transition: all 0.2s ease-in-out;
  cursor: pointer;
  border: var(--border) solid var(--color-base-300);
}

.graph-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  border-color: var(--color-primary);
}

.graph-card-image {
  width: 100%;
  height: auto;
  aspect-ratio: 16 / 9;
  object-fit: cover;
  background: linear-gradient(135deg, var(--color-primary)/10, var(--color-secondary)/10);
}

.domain-badge {
  font-size: 0.75rem;
  font-weight: 500;
}

.provider-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.75rem;
  color: var(--color-base-content)/60;
}

.stats-info {
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 0.75rem;
  color: var(--color-base-content)/60;
}

.graph-preview-tooltip {
  position: absolute;
  z-index: 1000;
  background: var(--color-base-100);
  border: var(--border) solid var(--color-base-300);
  border-radius: var(--radius-box);
  padding: 1rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  max-width: 320px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease-in-out;
}

.graph-preview-tooltip.show {
  opacity: 1;
}

.search-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--color-base-100);
  border: var(--border) solid var(--color-base-300);
  border-top: none;
  border-radius: 0 0 var(--radius-box) var(--radius-box);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  z-index: 100;
  max-height: 200px;
  overflow-y: auto;
}

.suggestion-item {
  padding: 0.75rem 1rem;
  cursor: pointer;
  transition: background-color 0.15s ease-in-out;
  border-bottom: var(--border) solid var(--color-base-200);
}

.suggestion-item:hover {
  background-color: var(--color-base-200);
}

.suggestion-item:last-child {
  border-bottom: none;
}

.fade-in {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.clear-search-btn {
  position: absolute;
  right: 60px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--color-base-content)/50;
  cursor: pointer;
  padding: 0.25rem;
  border-radius: var(--radius-field);
  transition: color 0.15s ease-in-out;
}

.clear-search-btn:hover {
  color: var(--color-base-content);
}

.search-container {
  position: relative;
}

.favorite-btn {
  transition: all 0.15s ease-in-out;
}

.favorite-btn.favorited {
  color: var(--color-error);
}

.favorite-btn:hover {
  transform: scale(1.1);
}

/* 范围滑块样式优化 */
.range::-webkit-slider-thumb {
  background: var(--color-primary);
  border: 2px solid var(--color-base-100);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.range::-moz-range-thumb {
  background: var(--color-primary);
  border: 2px solid var(--color-base-100);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* 筛选器标题图标对齐 */
.filter-section-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

/* 卡片内容层次优化 */
.card-title-section {
  margin-bottom: 0.75rem;
}

.card-description {
  margin-bottom: 1rem;
  line-height: 1.4;
}

.card-meta-section {
  margin-bottom: 0.75rem;
}

.card-stats-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* 筛选器分组样式 */
.filter-group {
  border-radius: var(--radius-box);
}

.filter-group .collapse-title {
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 500;
  color: var(--color-base-content);
  transition: all 0.15s ease-in-out;
}

.filter-group .collapse-title:hover {
  background-color: var(--color-base-300);
}

.filter-group .collapse-content {
  background-color: transparent;
}

/* 筛选按钮网格布局优化 */
.filter-group .btn-xs {
  font-size: 0.65rem;
  padding: 0.25rem 0.5rem;
  min-height: 1.5rem;
  height: 1.5rem;
}

/* 范围滑块优化 */
.range-xs {
  height: 0.75rem;
}

.range-xs::-webkit-slider-thumb {
  width: 0.875rem;
  height: 0.875rem;
}

.range-xs::-moz-range-thumb {
  width: 0.875rem;
  height: 0.875rem;
}

/* 标签文字优化 */
.label-text {
  font-size: 0.75rem;
  font-weight: 500;
}

.label-text-alt {
  font-size: 0.65rem;
  font-weight: 600;
  color: var(--color-primary);
}

/* 输入框优化 */
.input-xs {
  font-size: 0.75rem;
  padding: 0.25rem 0.5rem;
  min-height: 1.75rem;
  height: 1.75rem;
}

/* 折叠面板动画优化 */
.collapse-content {
  transition: all 0.2s ease-in-out;
}

/* 筛选器容器间距优化 */
.filter-group + .filter-group {
  margin-top: 0.75rem;
}

/* 响应式优化 */
@media (max-width: 1024px) {
  .filter-group .grid-cols-2 {
    grid-template-columns: 1fr;
  }
  
  .filter-group .btn-xs {
    justify-content: center;
  }
}

/* 与其他页面一致的响应式调整 */
@media (max-width: 768px) {
  /* 统一区块上下留白与网格间距 */
  section { padding-top: 3rem; padding-bottom: 3rem; }
  .academic-grid { gap: 1rem; }
  /* 头图/标题区域字号缩放 */
  h1 { font-size: 2.5rem; }
  p { font-size: 1.125rem; }
}

@media (max-width: 640px) {
  .header-height { height: 56px; }
  .join .input { height: 3rem; }
  .join .btn { height: 3rem; }
  /* 卡片图片在超小屏更紧凑 */
  .card figure img { height: 10rem; object-fit: cover; }
}

/* 结果工具栏在中小屏堆叠显示 */
@media (max-width: 768px) {
  .results-toolbar {
    flex-direction: column;
    align-items: stretch;
    gap: 0.75rem;
  }
  .results-toolbar #resultCount {
    text-align: left;
  }
}
</style>
  <script src="/assets/static/libs/25_6/holder.js"></script></head>
  <body class="bg-base-100">
    <div data-section-id="common_header" data-section-type="common_header">
  <div id="ijzt" class="navbar bg-base-100 shadow-soft border-b academic-border header-height px-4 ijzt spark-custom-ijzt ijzt">
    <!-- Left section: Logo -->
    <div class="navbar-start">
      <div class="flex items-center gap-4">
        <button class="btn btn-ghost text-xl font-bold text-base-content hover:bg-base-content/10" onclick="navigateTo(&#39;home_page&#39;)">
          <span class="iconify" data-icon="heroicons:cube-transparent" data-width="28"></span>
          Graph+知识图谱平台
        </button>
      </div>
      <!-- Mobile menu (visible on small screens) -->
      <div class="dropdown lg:hidden">
        <div tabindex="0" role="button" class="btn btn-ghost btn-sm">
          <span class="iconify" data-icon="heroicons:bars-3" data-width="22"></span>
        </div>
        <ul tabindex="0" class="dropdown-content z-50 menu p-2 shadow-lg bg-base-100 rounded-box w-52 mt-2">
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;home_page&#39;)">首页</a></li>
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;graph_list_page&#39;)">探索</a></li>
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;page_998125&#39;)">论坛</a></li>
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;page_998124&#39;)">管理</a></li>
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;documentation_page&#39;)">使用文档</a></li>
          <li><a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;about_page&#39;)">关于我们</a></li>
        </ul>
      </div>
    </div>
    <!-- Center section: Main navigation -->
    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal px-1 gap-2">
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;home_page&#39;)">首页</a>
        </li>
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;graph_list_page&#39;)">探索</a>
        </li>
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;page_998125&#39;)">论坛</a>
        </li>
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;page_998124&#39;)">管理</a>
        </li>
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;documentation_page&#39;)">使用文档</a>
        </li>
        <li>
          <a class="nav-hover focus-primary text-base-content" onclick="navigateTo(&#39;about_page&#39;)">关于我们</a>
        </li>
      </ul>
    </div>
    <!-- Right section: User controls -->
    <div class="navbar-end">
      <!-- Login/Register buttons for logged-out users -->
      <div data-user-control="logged-out" class="flex items-center gap-2" style="display: none;">
        <button class="btn btn-ghost btn-sm text-base-content hover:bg-base-content/10" onclick="navigateTo(&#39;login_register_page&#39;)">
          登录</button><button class="btn btn-outline btn-sm border-base-content text-base-content hover:bg-base-content hover:text-base-100" onclick="navigateTo(&#39;login_register_page&#39;)">
          注册
        </button>
      </div>
      <!-- User profile dropdown for logged-in users -->
      <div data-user-control="logged-in" id="i1jf9" class="dropdown dropdown-end" style="display: none;">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar focus-primary">
          <div id="nav-avatar-container" class="avatar placeholder inline-flex items-center justify-center w-10 h-10 rounded-full bg-primary text-primary-content overflow-hidden">
            <span id="nav-avatar-text" class="font-semibold text-lg">用</span>
            <img id="nav-avatar-img" class="w-full h-full object-cover hidden" alt="头像">
          </div>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-50 p-2 shadow-soft bg-base-100 rounded-box w-52">
          <li class="menu-title"><span>用户中心</span></li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateTo(&#39;user_profile_page&#39;)"><span class="iconify" data-icon="heroicons:user" data-width="16"></span><span>个人资料</span></a>
          </li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateToFavorites()"><span class="iconify" data-icon="heroicons:heart" data-width="16"></span><span>我的收藏</span></a>
          </li>
          <li>
            <a class="nav-hover focus-primary" onclick="navigateTo(&#39;user_profile_page&#39;)"><span class="iconify" data-icon="heroicons:clock" data-width="16"></span><span>历史记录</span></a>
          </li>
          <li id="admin-menu-item" style="display: none;">
            <a class="nav-hover focus-primary text-primary" onclick="navigateTo(&#39;admin_dashboard_page&#39;)"><span class="iconify" data-icon="heroicons:cog-6-tooth" data-width="16"></span><span>管理后台</span></a>
          </li>
          <div class="divider my-1"></div>
          <li>
            <a class="nav-hover focus-primary text-error" onclick="window.APP_GLOBALS.user.logout()"><span class="iconify" data-icon="heroicons:arrow-right-on-rectangle" data-width="16"></span><span>退出登录</span></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <main class="min-h-screen bg-base-200">
      <!-- 图谱列表页头部 -->
      <section class="bg-base-100 py-16 px-4">
        <div class="container mx-auto max-w-6xl text-center">
          <h1 data-type="text" class="text-4xl font-bold text-base-content mb-4">
            知识图谱探索
          </h1>
          <p data-type="text" class="text-lg text-base-content/70 mb-8">
            在这里发现和探索海量的知识图谱，助您洞察数据背后的关联与价值。
          </p>
          <!-- 搜索组件 -->
          <div class="flex justify-center">
            <div class="join w-full max-w-md search-container">
              <input type="text" placeholder="搜索知识图谱..." id="searchInput" data-type="input" class="input input-bordered join-item w-full focus-primary"><button data-type="button" class="btn btn-primary join-item" onclick="performSearch()">
                <span class="iconify" data-icon="heroicons:magnifying-glass" data-width="20"></span>
              </button>
              <div id="searchSuggestions" class="search-suggestions hidden"></div>
            </div>
          </div>
        </div>
      </section>
      <!-- 图谱筛选与列表区 -->
      <section class="py-8 px-4">
        <div class="container mx-auto max-w-7xl">
          <div class="flex flex-col lg:flex-row gap-8">
            <!-- 左侧筛选器 -->
            <div class="lg:w-80 flex-shrink-0">
              <div class="card bg-base-100 shadow-soft">
                <div id="iyvyn" class="card-body p-4 iyvyn spark-custom-iyvyn iyvyn">
                  <!-- 筛选器分组 -->
                  <div class="space-y-4">
                    <!-- 基础筛选组 -->
                    <div class="filter-group">
                      <div class="collapse collapse-open bg-base-200/50 rounded-lg">
                        <input type="checkbox" checked="" class="collapse-toggle">
                        <div class="collapse-title text-sm font-medium px-4 py-2 min-h-0">
                          <span class="iconify" data-icon="heroicons:funnel" data-width="16"></span>
                          基础筛选
                        </div>
                        <div class="collapse-content px-4 pb-4">
                          <!-- 领域分类筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:squares-2x2" data-width="16"></span>
                              领域分类
                            </h4>
                            <div class="grid grid-cols-2 gap-1">
                              <button data-filter="all" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn active" onclick="filterGraphs(&#39;all&#39;)">
                                <span class="iconify" data-icon="heroicons:squares-2x2" data-width="12"></span>
                                全部</button><button data-filter="humanities" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;humanities&#39;)">
                                <span class="iconify" data-icon="heroicons:book-open" data-width="12"></span>
                                人文</button><button data-filter="history" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;history&#39;)">
                                <span class="iconify" data-icon="heroicons:clock" data-width="12"></span>
                                历史</button><button data-filter="science" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;science&#39;)">
                                <span class="iconify" data-icon="heroicons:beaker" data-width="12"></span>
                                科学</button><button data-filter="technology" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;technology&#39;)">
                                <span class="iconify" data-icon="heroicons:cpu-chip" data-width="12"></span>
                                技术</button><button data-filter="medicine" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;medicine&#39;)">
                                <span class="iconify" data-icon="heroicons:heart" data-width="12"></span>
                                医学</button><button data-filter="economics" data-type="button" class="btn btn-ghost btn-xs justify-start filter-btn" onclick="filterGraphs(&#39;economics&#39;)">
                                <span class="iconify" data-icon="heroicons:chart-bar" data-width="12"></span>
                                经济
                              </button>
                            </div>
                          </div>
                          <!-- 关键词筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:magnifying-glass" data-width="16"></span>
                              关键词筛选
                            </h4>
                            <input type="text" placeholder="输入关键词..." id="keywordFilter" data-type="input" class="input input-bordered input-xs w-full focus-primary">
                          </div>
                          <!-- 日期筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:calendar" data-width="16"></span>
                              创建日期
                            </h4>
                            <div class="grid grid-cols-2 gap-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">开始</span></label><input type="date" id="startDate" data-type="input" class="input input-bordered input-xs focus-primary">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">结束</span></label><input type="date" id="endDate" data-type="input" class="input input-bordered input-xs focus-primary">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- 图谱结构筛选组 -->
                    <div class="filter-group">
                      <div class="collapse bg-base-200/50 rounded-lg">
                        <input type="checkbox" class="collapse-toggle">
                        <div class="collapse-title text-sm font-medium px-4 py-2 min-h-0">
                          <span class="iconify" data-icon="heroicons:chart-bar-square" data-width="16"></span>
                          图谱结构
                        </div>
                        <div class="collapse-content px-4 pb-4">
                          <!-- 节点数量筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:circle" data-width="16"></span>
                              节点数量
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小节点数</span><span id="minNodesValue" class="label-text-alt text-xs">0</span></label><input type="range" min="0" max="10000" value="0" id="minNodesRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大节点数</span><span id="maxNodesValue" class="label-text-alt text-xs">10000</span></label><input type="range" min="0" max="10000" value="10000" id="maxNodesRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                          <!-- 关系数筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:arrow-right" data-width="16"></span>
                              关系数
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小关系数</span><span id="minEdgesValue" class="label-text-alt text-xs">0</span></label><input type="range" min="0" max="20000" value="0" id="minEdgesRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大关系数</span><span id="maxEdgesValue" class="label-text-alt text-xs">20000</span></label><input type="range" min="0" max="20000" value="20000" id="maxEdgesRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                          <!-- 图谱密度筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:squares-plus" data-width="16"></span>
                              图谱密度
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小密度</span><span id="minDensityValue" class="label-text-alt text-xs">0.0</span></label><input type="range" min="0" max="100" value="0" id="minDensityRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大密度</span><span id="maxDensityValue" class="label-text-alt text-xs">10.0</span></label><input type="range" min="0" max="100" value="100" id="maxDensityRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- 质量指标筛选组 -->
                    <div class="filter-group">
                      <div class="collapse bg-base-200/50 rounded-lg">
                        <input type="checkbox" class="collapse-toggle">
                        <div class="collapse-title text-sm font-medium px-4 py-2 min-h-0">
                          <span class="iconify" data-icon="heroicons:star" data-width="16"></span>
                          质量指标
                        </div>
                        <div class="collapse-content px-4 pb-4">
                          <!-- 实体丰富度筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:cube" data-width="16"></span>
                              实体丰富度
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小丰富度</span><span id="minEntityRichnessValue" class="label-text-alt text-xs">0.0</span></label><input type="range" min="0" max="100" value="0" id="minEntityRichnessRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大丰富度</span><span id="maxEntityRichnessValue" class="label-text-alt text-xs">10.0</span></label><input type="range" min="0" max="100" value="100" id="maxEntityRichnessRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                          <!-- 关系丰富度筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:link" data-width="16"></span>
                              关系丰富度
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小丰富度</span><span id="minRelationRichnessValue" class="label-text-alt text-xs">0.0</span></label><input type="range" min="0" max="100" value="0" id="minRelationRichnessRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大丰富度</span><span id="maxRelationRichnessValue" class="label-text-alt text-xs">10.0</span></label><input type="range" min="0" max="100" value="100" id="maxRelationRichnessRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- 热度指标筛选组 -->
                    <div class="filter-group">
                      <div class="collapse bg-base-200/50 rounded-lg">
                        <input type="checkbox" class="collapse-toggle">
                        <div class="collapse-title text-sm font-medium px-4 py-2 min-h-0">
                          <span class="iconify" data-icon="heroicons:fire" data-width="16"></span>
                          热度指标
                        </div>
                        <div class="collapse-content px-4 pb-4">
                          <!-- 浏览次数筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:eye" data-width="16"></span>
                              浏览次数
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小浏览数</span><span id="minViewCountValue" class="label-text-alt text-xs">0</span></label><input type="range" min="0" max="30000" value="0" id="minViewCountRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大浏览数</span><span id="maxViewCountValue" class="label-text-alt text-xs">30000</span></label><input type="range" min="0" max="30000" value="30000" id="maxViewCountRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                          <!-- 下载次数筛选 -->
                          <div class="mb-4">
                            <h4 class="text-sm font-medium mb-2 flex items-center gap-2">
                              <span class="iconify" data-icon="heroicons:arrow-down-tray" data-width="16"></span>
                              下载次数
                            </h4>
                            <div class="space-y-2">
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最小下载数</span><span id="minDownloadCountValue" class="label-text-alt text-xs">0</span></label><input type="range" min="0" max="5000" value="0" id="minDownloadCountRange" data-type="input" class="range range-primary range-xs">
                              </div>
                              <div class="form-control">
                                <label class="label py-1"><span class="label-text text-xs">最大下载数</span><span id="maxDownloadCountValue" class="label-text-alt text-xs">5000</span></label><input type="range" min="0" max="5000" value="5000" id="maxDownloadCountRange" data-type="input" class="range range-primary range-xs">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- 重置筛选 -->
                    <div class="mt-4">
                      <button data-type="button" id="i33eg4" class="btn btn-outline btn-sm w-full i33eg4 spark-custom-i33eg4" onclick="resetFilters()">
                        <span class="iconify" data-icon="heroicons:arrow-path" data-width="16"></span>
                        重置筛选
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 右侧主内容区 -->
            <div class="flex-1">
              <!-- 视图切换和结果计数 -->
              <div class="flex justify-between items-center mb-6 results-toolbar">
                <div class="flex gap-2">
                  <button data-view="recommended" data-type="button" class="btn btn-primary btn-sm view-toggle active" onclick="toggleView(&#39;recommended&#39;)">
                    <span class="iconify" data-icon="heroicons:star" data-width="16"></span>
                    推荐</button><button data-view="popular" data-type="button" class="btn btn-ghost btn-sm view-toggle" onclick="toggleView(&#39;popular&#39;)">
                    <span class="iconify" data-icon="heroicons:fire" data-width="16"></span>
                    热门
                  </button>
                </div>
                <div id="resultCount" data-type="text" class="text-sm text-base-content/70">
                  共找到 12 个图谱
                </div>
              </div>
              <!-- 图谱卡片网格 -->
              <div id="graphGrid" data-type="container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 academic-grid">
                <!-- 图谱卡片将通过JavaScript动态生成 -->
              </div>
              <!-- 分页 -->
              <div class="flex justify-center mt-8">
                <div class="join">
                  <button data-type="button" class="join-item btn btn-sm">
                    «</button><button data-type="button" class="join-item btn btn-sm btn-active">
                    1</button><button data-type="button" class="join-item btn btn-sm">
                    2</button><button data-type="button" class="join-item btn btn-sm">
                    3</button><button data-type="button" class="join-item btn btn-sm">
                    »
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <div data-section-id="common_footer" data-section-type="common_footer">
  <footer class="footer footer-center p-6 bg-base-200 text-base-content border-t academic-border">
    <div class="grid grid-flow-col gap-4">
      <a class="link link-hover focus-primary" onclick="navigateTo(&#39;about_page&#39;)">关于我们</a><a class="link link-hover focus-primary" onclick="navigateTo(&#39;documentation_page&#39;)">帮助中心</a><a class="link link-hover focus-primary" onclick="navigateTo(&#39;feedback_page&#39;)">用户反馈</a><a class="link link-hover focus-primary">隐私政策</a><a class="link link-hover focus-primary">服务条款</a>
    </div>
    <div class="grid grid-flow-col gap-4">
      <a aria-label="官方微信" class="link link-hover focus-primary"><span class="iconify" data-icon="simple-icons:wechat" data-width="20" style="color: var(--color-success);" data-style-id="gjs-style-1" id="i5xzyy"></span></a><a aria-label="企业QQ" class="link link-hover focus-primary"><span class="iconify" data-icon="simple-icons:tencentqq" data-width="20" style="color: var(--color-primary);" data-style-id="gjs-style-2" id="i91rrl"></span></a><a aria-label="意见反馈" class="link link-hover focus-primary" onclick="navigateTo(&#39;feedback_page&#39;)"><span class="iconify" data-icon="heroicons:chat-bubble-left-right" data-width="20"></span></a>
    </div>
    <div class="text-center">
      <p class="icojag spark-custom-icojag" id="icojag">
        © 2025 Graph+知识图谱平台. 版权所有 |
        <span class="text-primary font-medium">智慧知识发现与探索</span>
      </p>
      <p class="text-xs opacity-70 mt-1">
        反馈邮箱: feedback@knowledgegraph.com
      </p>
    </div>
  </footer>
</div>
<script>
(function() {
&#39;use strict&#39;;

// Initialize global namespace
window.APP_GLOBALS = window.APP_GLOBALS || {};

// Global navigation utility
window.navigateTo = function(targetPageId, params) {
const isInIframe = window.self !== window.top;

if (isInIframe) {
window.parent.postMessage({
type: &#39;iframeNavigation&#39;,
targetPageId: targetPageId,
params: params
}, &#39;*&#39;);
} else {
let url = `${targetPageId}.html`;
if (params) {
const queryString = Object.keys(params).map(k =&gt; k + &#39;=&#39; + encodeURIComponent(params[k])).join(&#39;&amp;&#39;);
url += &#39;?&#39; + queryString;
}
window.location.href = url;
}
};

window.navigateToFavorites = function() {
navigateTo(&#39;user_profile_page&#39;, { section: &#39;favorites&#39; });
};

// User authentication state management
window.APP_GLOBALS.user = {
isLoggedIn: false,
userInfo: null,

login: function(userInfo) {
this.isLoggedIn = true;
this.userInfo = userInfo;
localStorage.setItem(&#39;userState&#39;, JSON.stringify({
isLoggedIn: true,
userInfo: userInfo
}));
this.updateUserInterface();
},

logout: function() {
this.isLoggedIn = false;
this.userInfo = null;
localStorage.removeItem(&#39;userState&#39;);
fetch(&#39;/api/auth/logout&#39;, { method: &#39;POST&#39;, credentials: &#39;include&#39; })
.finally(() =&gt; {
this.updateUserInterface();
window.top.location.href = &#39;/graph/home.html&#39;;
});
},

updateUserInterface: function() {
const userControls = document.querySelectorAll(&#39;[data-user-control]&#39;);
userControls.forEach(control => {
const controlType = control.getAttribute(&#39;data-user-control&#39;);
if (controlType === &#39;logged-out&#39; &amp;&amp; this.isLoggedIn) {
control.style.display = &#39;none&#39;;
} else if (controlType === &#39;logged-in&#39; &amp;&amp; !this.isLoggedIn) {
control.style.display = &#39;none&#39;;
} else {
control.style.display = &#39;&#39;;
}
});
// 更新导航栏头像
if (this.isLoggedIn &amp;&amp; this.userInfo) {
const avatarText = document.getElementById(&#39;nav-avatar-text&#39;);
const avatarImg = document.getElementById(&#39;nav-avatar-img&#39;);
if (avatarText &amp;&amp; avatarImg) {
if (this.userInfo.avatar) {
avatarText.classList.add(&#39;hidden&#39;);
avatarImg.src = this.userInfo.avatar;
avatarImg.classList.remove(&#39;hidden&#39;);
} else {
const name = this.userInfo.userName || &#39;用&#39;;
avatarText.textContent = name.substring(0, 1);
avatarText.classList.remove(&#39;hidden&#39;);
avatarImg.classList.add(&#39;hidden&#39;);
}
}
const adminMenuItem = document.getElementById(&#39;admin-menu-item&#39;);
if (adminMenuItem) {
adminMenuItem.style.display = this.userInfo.role === &#39;ADMIN&#39; ? &#39;&#39; : &#39;none&#39;;
}
}
},

init: function() {
// 先用缓存状态快速显示，避免闪烁
const savedState = localStorage.getItem(&#39;userState&#39;);
if (savedState) {
const state = JSON.parse(savedState);
this.isLoggedIn = state.isLoggedIn;
this.userInfo = state.userInfo;
this.updateUserInterface();
}
// 再异步验证真实状态
fetch(&#39;/user/api/check-auth&#39;, { credentials: &#39;include&#39; })
.then(res => res.json())
.then(data => {
const wasLoggedIn = this.isLoggedIn;
if (data.authenticated) {
this.isLoggedIn = true;
this.userInfo = data.user || { userName: data.username };
localStorage.setItem(&#39;userState&#39;, JSON.stringify({ isLoggedIn: true, userInfo: this.userInfo }));
} else {
this.isLoggedIn = false;
this.userInfo = null;
localStorage.removeItem(&#39;userState&#39;);
}
if (wasLoggedIn !== this.isLoggedIn || !savedState) this.updateUserInterface();
})
.catch(() => {});
}
};

// Search functionality
window.APP_GLOBALS.search = {
history: JSON.parse(localStorage.getItem(&#39;searchHistory&#39;) || &#39;[]&#39;),
recommendations: [&#39;人工智能&#39;, &#39;机器学习&#39;, &#39;自然语言处理&#39;, &#39;计算机视觉&#39;, &#39;深度学习&#39;],

addToHistory: function(query) {
if (query &amp;&amp; !this.history.includes(query)) {
this.history.unshift(query);
this.history = this.history.slice(0, 10); // Keep only last 10 searches
localStorage.setItem(&#39;searchHistory&#39;, JSON.stringify(this.history));
}
},

getSearchSuggestions: function() {
return this.history.length > 0 ? this.history : this.recommendations;
},

performSearch: function(query, targetPage = &#39;graph_list_page&#39;) {
this.addToHistory(query);
// Navigate to search results or graph detail based on context
navigateTo(targetPage);
}
};

// Notification utilities
window.showNotification = function(message, type = &#39;info&#39;) {
const notification = document.createElement(&#39;div&#39;);
notification.className = `alert alert-${type} fixed top-4 right-4 w-96 z-50 shadow-lg`;
notification.innerHTML = `
<div class="flex items-center gap-2">
<span class="iconify" data-icon="heroicons:information-circle-solid" data-width="20"></span>
<span>${message}</span>
</div>
`;
document.body.appendChild(notification);

setTimeout(() => {
notification.remove();
}, 5000);
};

// Favorites management
window.APP_GLOBALS.favorites = {
items: JSON.parse(localStorage.getItem(&#39;graph_favorites&#39;) || &#39;[]&#39;),

add: async function(graphId, graphData) {
try {
const res = await fetch(&#39;/api/graph/&#39; + graphId + &#39;/favorite&#39;, {
method: &#39;POST&#39;,
credentials: &#39;include&#39;
});
const data = await res.json();
if (data.success) {
if (!this.items.find(item =&gt; item.id === graphId)) {
this.items.push({ id: graphId, data: graphData, addedAt: new Date().toISOString() });
localStorage.setItem(&#39;graph_favorites&#39;, JSON.stringify(this.items));
}
showNotification(&#39;已添加到收藏&#39;, &#39;success&#39;);
} else {
showNotification(data.error || &#39;收藏失败，请先登录&#39;, &#39;error&#39;);
}
} catch(e) {
showNotification(&#39;收藏失败，请先登录&#39;, &#39;error&#39;);
}
},

remove: async function(graphId) {
try {
const res = await fetch(&#39;/api/graph/&#39; + graphId + &#39;/favorite&#39;, {
method: &#39;POST&#39;,
credentials: &#39;include&#39;
});
const data = await res.json();
if (data.success) {
this.items = this.items.filter(item =&gt; item.id !== graphId);
localStorage.setItem(&#39;graph_favorites&#39;, JSON.stringify(this.items));
showNotification(&#39;已从收藏中移除&#39;, &#39;info&#39;);
} else {
showNotification(data.error || &#39;操作失败&#39;, &#39;error&#39;);
}
} catch(e) {
showNotification(&#39;操作失败&#39;, &#39;error&#39;);
}
},

isFavorited: function(graphId) {
return this.items.some(item =&gt; item.id === graphId);
},

toggle: async function(graphId, graphData) {
if (this.isFavorited(graphId)) {
await this.remove(graphId);
} else {
await this.add(graphId, graphData);
}
}
};

// Initialize components when DOM is loaded
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
window.APP_GLOBALS.user.init();
});

})();
</script><script>
let currentView = &#39;recommended&#39;;
let currentFilter = &#39;all&#39;;
let allGraphs = [];      // 所有加载的图谱
let filteredData = [];   // 筛选后的图谱
let currentPage = 0;
let totalPages = 0;
let isLoading = false;

// 页面初始化
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
  window.APP_GLOBALS.user.init();
  initializeSearchComponent();
  initializeRangeSliders();
  initializeFilters();
  // 从API加载图谱数据
  loadGraphs();
});

// ==================== API 数据加载 ====================

// 加载公开图谱列表
async function loadGraphs(page = 0) {
  if (isLoading) return;
  isLoading = true;
  
  showLoadingState();
  
  try {
    const sortBy = currentView === &#39;popular&#39; ? &#39;viewCount&#39; : &#39;lastModified&#39;;
    const response = await fetch(`/api/graph/public?page=${page}&amp;size=12&amp;sortBy=${sortBy}`, {
      method: &#39;GET&#39;,
      credentials: &#39;include&#39;
    });
    
    if (!response.ok) {
      throw new Error(&#39;加载失败&#39;);
    }
    
    const data = await response.json();
    allGraphs = (data.content || []).map(transformGraphData);
    filteredData = allGraphs;
    currentPage = data.currentPage || 0;
    totalPages = data.totalPages || 1;
    
    renderGraphGrid();
    updateResultCount();
  } catch (error) {
    console.error(&#39;加载图谱失败:&#39;, error);
    showEmptyState(&#39;加载失败，请刷新重试&#39;);
  } finally {
    isLoading = false;
  }
}

// 搜索图谱
async function searchGraphsFromAPI(keyword, page = 0) {
  if (isLoading) return;
  isLoading = true;
  
  showLoadingState();
  
  try {
    const response = await fetch(`/api/graph/search?keyword=${encodeURIComponent(keyword)}&amp;page=${page}&amp;size=12`, {
      method: &#39;GET&#39;,
      credentials: &#39;include&#39;
    });
    
    if (!response.ok) {
      throw new Error(&#39;搜索失败&#39;);
    }
    
    const data = await response.json();
    allGraphs = (data.content || []).map(transformGraphData);
    filteredData = allGraphs;
    currentPage = data.currentPage || 0;
    totalPages = data.totalPages || 1;
    
    renderGraphGrid();
    updateResultCount();
    
    if (allGraphs.length === 0) {
      showEmptyState(`未找到与"${keyword}"相关的图谱`);
    }
  } catch (error) {
    console.error(&#39;搜索失败:&#39;, error);
    showEmptyState(&#39;搜索失败，请重试&#39;);
  } finally {
    isLoading = false;
  }
}

// 加载热门图谱
async function loadPopularGraphs() {
  if (isLoading) return;
  isLoading = true;
  
  showLoadingState();
  
  try {
    const response = await fetch(&#39;/api/graph/popular?limit=12&#39;, {
      method: &#39;GET&#39;,
      credentials: &#39;include&#39;
    });
    
    if (!response.ok) {
      throw new Error(&#39;加载失败&#39;);
    }
    
    const data = await response.json();
    allGraphs = (data || []).map(transformGraphData);
    filteredData = allGraphs;
    
    renderGraphGrid();
    updateResultCount();
  } catch (error) {
    console.error(&#39;加载热门图谱失败:&#39;, error);
    showEmptyState(&#39;加载失败，请刷新重试&#39;);
  } finally {
    isLoading = false;
  }
}

// 转换后端数据格式为前端格式
function transformGraphData(graph) {
  return {
    id: graph.graphId,
    title: graph.name || &#39;未命名图谱&#39;,
    domain: &#39;知识图谱&#39;,
    domainKey: &#39;technology&#39;,
    description: graph.description || &#39;暂无描述&#39;,
    nodes: graph.nodeCount || 0,
    edges: graph.relationCount || 0,
    provider: graph.uploaderName || &#39;匿名用户&#39;,
    viewCount: graph.viewCount || 0,
    downloadCount: graph.downloadCount || 0,
    createDate: graph.uploadDate || &#39;&#39;,
    density: parseFloat(graph.density) || 0,
    entityRichness: parseFloat(graph.entityRichness) || 0,
    relationRichness: parseFloat(graph.relationRichness) || 0,
    image: graph.coverImage || &#39;https://placehold.co/400x200.png?text=Knowledge+Graph&#39;
  };
}

// 显示加载状态
function showLoadingState() {
  const container = document.getElementById(&#39;graphGrid&#39;);
  container.innerHTML = `
    &lt;div class="col-span-full flex flex-col items-center justify-center py-16"&gt;
      &lt;span class="loading loading-spinner loading-lg text-primary"&gt;&lt;/span&gt;
      &lt;p class="mt-4 text-base-content/60"&gt;加载中...&lt;/p&gt;
    &lt;/div&gt;
  `;
}

// 显示空状态
function showEmptyState(message) {
  const container = document.getElementById(&#39;graphGrid&#39;);
  container.innerHTML = `
    &lt;div class="col-span-full flex flex-col items-center justify-center py-16"&gt;
      &lt;span class="iconify text-base-content/30" data-icon="heroicons:inbox" data-width="64"&gt;&lt;/span&gt;
      &lt;p class="mt-4 text-base-content/60"&gt;${message}&lt;/p&gt;
    &lt;/div&gt;
  `;
}

// 初始化搜索组件
function initializeSearchComponent() {
  const searchInput = document.getElementById(&#39;searchInput&#39;);
  const searchContainer = searchInput.closest(&#39;.search-container&#39;);
  
  // 创建搜索建议容器
  const suggestionsContainer = document.createElement(&#39;div&#39;);
  suggestionsContainer.className = &#39;search-suggestions hidden&#39;;
  suggestionsContainer.id = &#39;searchSuggestions&#39;;
  searchContainer.appendChild(suggestionsContainer);
  
  // 添加清除按钮
  const clearBtn = document.createElement(&#39;button&#39;);
  clearBtn.className = &#39;clear-search-btn hidden&#39;;
  clearBtn.innerHTML = &#39;<span class="iconify" data-icon="heroicons:x-mark" data-width="16"></span>&#39;;
  clearBtn.onclick = clearSearch;
  searchContainer.appendChild(clearBtn);
  
  // 搜索输入事件
  searchInput.addEventListener(&#39;input&#39;, function(e) {
    const query = e.target.value.trim();
    if (query.length > 0) {
      clearBtn.classList.remove(&#39;hidden&#39;);
      showSearchSuggestions(query);
    } else {
      clearBtn.classList.add(&#39;hidden&#39;);
      hideSearchSuggestions();
    }
    applyFilters();
  });
  
  // 点击外部隐藏建议
  document.addEventListener(&#39;click&#39;, function(e) {
    if (!searchContainer.contains(e.target)) {
      hideSearchSuggestions();
    }
  });
  
  // 回车搜索
  searchInput.addEventListener(&#39;keydown&#39;, function(e) {
    if (e.key === &#39;Enter&#39;) {
      performSearch();
    }
  });
}

// 初始化范围滑块
function initializeRangeSliders() {
  const sliders = [
    { range: &#39;minNodesRange&#39;, value: &#39;minNodesValue&#39; },
    { range: &#39;maxNodesRange&#39;, value: &#39;maxNodesValue&#39; },
    { range: &#39;minEdgesRange&#39;, value: &#39;minEdgesValue&#39; },
    { range: &#39;maxEdgesRange&#39;, value: &#39;maxEdgesValue&#39; },
    { range: &#39;minDensityRange&#39;, value: &#39;minDensityValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;maxDensityRange&#39;, value: &#39;maxDensityValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;minEntityRichnessRange&#39;, value: &#39;minEntityRichnessValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;maxEntityRichnessRange&#39;, value: &#39;maxEntityRichnessValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;minRelationRichnessRange&#39;, value: &#39;minRelationRichnessValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;maxRelationRichnessRange&#39;, value: &#39;maxRelationRichnessValue&#39;, format: &#39;decimal&#39; },
    { range: &#39;minViewCountRange&#39;, value: &#39;minViewCountValue&#39; },
    { range: &#39;maxViewCountRange&#39;, value: &#39;maxViewCountValue&#39; },
    { range: &#39;minDownloadCountRange&#39;, value: &#39;minDownloadCountValue&#39; },
    { range: &#39;maxDownloadCountRange&#39;, value: &#39;maxDownloadCountValue&#39; }
  ];
  
  sliders.forEach(slider => {
    const rangeElement = document.getElementById(slider.range);
    const valueElement = document.getElementById(slider.value);
    
    if (rangeElement &amp;&amp; valueElement) {
      rangeElement.addEventListener(&#39;input&#39;, function() {
        let displayValue = this.value;
        if (slider.format === &#39;decimal&#39;) {
          displayValue = (this.value / 10).toFixed(1);
        }
        valueElement.textContent = displayValue;
        applyFilters();
      });
    }
  });
}

// 初始化其他筛选器
function initializeFilters() {
  const keywordFilter = document.getElementById(&#39;keywordFilter&#39;);
  const startDate = document.getElementById(&#39;startDate&#39;);
  const endDate = document.getElementById(&#39;endDate&#39;);
  
  keywordFilter.addEventListener(&#39;input&#39;, applyFilters);
  startDate.addEventListener(&#39;change&#39;, applyFilters);
  endDate.addEventListener(&#39;change&#39;, applyFilters);
}

// 显示搜索建议
function showSearchSuggestions(query) {
  const suggestions = window.APP_GLOBALS.search.getSearchSuggestions();
  const filtered = suggestions.filter(item => 
    item.toLowerCase().includes(query.toLowerCase())
  );
  
  const container = document.getElementById(&#39;searchSuggestions&#39;);
  container.innerHTML = &#39;&#39;;
  
  if (filtered.length > 0) {
    filtered.forEach(suggestion => {
      const item = document.createElement(&#39;div&#39;);
      item.className = &#39;suggestion-item&#39;;
      item.innerHTML = `
        <div class="flex items-center gap-2">
          <span class="iconify" data-icon="heroicons:magnifying-glass" data-width="16"></span>
          <span>${suggestion}</span>
        </div>
      `;
      item.onclick = () => selectSuggestion(suggestion);
      container.appendChild(item);
    });
    container.classList.remove(&#39;hidden&#39;);
  } else {
    container.classList.add(&#39;hidden&#39;);
  }
}

// 隐藏搜索建议
function hideSearchSuggestions() {
  const container = document.getElementById(&#39;searchSuggestions&#39;);
  container.classList.add(&#39;hidden&#39;);
}

// 选择搜索建议
function selectSuggestion(suggestion) {
  const searchInput = document.getElementById(&#39;searchInput&#39;);
  searchInput.value = suggestion;
  hideSearchSuggestions();
  applyFilters();
}

// 清除搜索
function clearSearch() {
  const searchInput = document.getElementById(&#39;searchInput&#39;);
  const clearBtn = document.querySelector(&#39;.clear-search-btn&#39;);
  searchInput.value = &#39;&#39;;
  clearBtn.classList.add(&#39;hidden&#39;);
  hideSearchSuggestions();
  applyFilters();
}

// 执行搜索
function performSearch() {
  const searchInput = document.getElementById(&#39;searchInput&#39;);
  const query = searchInput.value.trim();
  
  if (query) {
    window.APP_GLOBALS.search.addToHistory(query);
    hideSearchSuggestions();
    window.showNotification(`正在搜索"${query}"...`, &#39;info&#39;);
    // 调用后端搜索 API
    searchGraphsFromAPI(query);
  } else {
    // 清空搜索时重新加载全部图谱
    loadGraphs();
  }
}

// 切换视图（推荐/热门）
function toggleView(view) {
  if (view === currentView) return;
  
  currentView = view;
  
  // 更新按钮状态
  document.querySelectorAll(&#39;.view-toggle&#39;).forEach(btn => {
    btn.classList.remove(&#39;active&#39;);
    btn.classList.add(&#39;btn-ghost&#39;);
    btn.classList.remove(&#39;btn-primary&#39;);
  });
  
  const activeBtn = document.querySelector(`[data-view="${view}"]`);
  activeBtn.classList.add(&#39;active&#39;);
  activeBtn.classList.remove(&#39;btn-ghost&#39;);
  activeBtn.classList.add(&#39;btn-primary&#39;);
  
  // 根据视图加载不同数据
  if (view === &#39;popular&#39;) {
    loadPopularGraphs();
  } else {
    loadGraphs();
  }
}

// 筛选图谱
function filterGraphs(filter) {
  if (filter === currentFilter) return;
  
  currentFilter = filter;
  
  // 更新筛选按钮状态
  document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn => {
    btn.classList.remove(&#39;active&#39;);
  });
  
  const activeBtn = document.querySelector(`[data-filter="${filter}"]`);
  activeBtn.classList.add(&#39;active&#39;);
  
  // 重新应用筛选
  applyFilters();
}

// 应用所有筛选条件
function applyFilters() {
  let data = [...allGraphs];
  
  // 领域筛选
  if (currentFilter !== &#39;all&#39;) {
    data = data.filter(graph => graph.domainKey === currentFilter);
  }
  
  // 关键词筛选
  const keyword = document.getElementById(&#39;keywordFilter&#39;).value.trim().toLowerCase();
  if (keyword) {
    data = data.filter(graph => 
      graph.title.toLowerCase().includes(keyword) ||
      graph.description.toLowerCase().includes(keyword) ||
      graph.provider.toLowerCase().includes(keyword)
    );
  }
  
  // 搜索框筛选
  const searchQuery = document.getElementById(&#39;searchInput&#39;).value.trim().toLowerCase();
  if (searchQuery) {
    data = data.filter(graph => 
      graph.title.toLowerCase().includes(searchQuery) ||
      graph.description.toLowerCase().includes(searchQuery) ||
      graph.provider.toLowerCase().includes(searchQuery)
    );
  }
  
  // 日期筛选
  const startDate = document.getElementById(&#39;startDate&#39;).value;
  const endDate = document.getElementById(&#39;endDate&#39;).value;
  if (startDate) {
    data = data.filter(graph => graph.createDate >= startDate);
  }
  if (endDate) {
    data = data.filter(graph => graph.createDate <= endDate);
  }
  
// 节点数量筛选
  const minNodes = parseInt(document.getElementById(&#39;minNodesRange&#39;).value);
  const maxNodes = parseInt(document.getElementById(&#39;maxNodesRange&#39;).value);
  data = data.filter(graph => graph.nodes >= minNodes &amp;&amp; graph.nodes <= maxNodes);
  
  // 关系数筛选
  const minEdges = parseInt(document.getElementById(&#39;minEdgesRange&#39;).value);
  const maxEdges = parseInt(document.getElementById(&#39;maxEdgesRange&#39;).value);
  data = data.filter(graph => graph.edges >= minEdges &amp;&amp; graph.edges <= maxEdges);
  
  // 图谱密度筛选
  const minDensity = parseFloat(document.getElementById(&#39;minDensityRange&#39;).value) / 10;
  const maxDensity = parseFloat(document.getElementById(&#39;maxDensityRange&#39;).value) / 10;
  data = data.filter(graph => graph.density >= minDensity &amp;&amp; graph.density <= maxDensity);
  
  // 实体丰富度筛选
  const minEntityRichness = parseFloat(document.getElementById(&#39;minEntityRichnessRange&#39;).value) / 10;
  const maxEntityRichness = parseFloat(document.getElementById(&#39;maxEntityRichnessRange&#39;).value) / 10;
  data = data.filter(graph => graph.entityRichness >= minEntityRichness &amp;&amp; graph.entityRichness <= maxEntityRichness);
  
  // 关系丰富度筛选
  const minRelationRichness = parseFloat(document.getElementById(&#39;minRelationRichnessRange&#39;).value) / 10;
  const maxRelationRichness = parseFloat(document.getElementById(&#39;maxRelationRichnessRange&#39;).value) / 10;
  data = data.filter(graph => graph.relationRichness >= minRelationRichness &amp;&amp; graph.relationRichness <= maxRelationRichness);
  
  // 浏览次数筛选
  const minViewCount = parseInt(document.getElementById(&#39;minViewCountRange&#39;).value);
  const maxViewCount = parseInt(document.getElementById(&#39;maxViewCountRange&#39;).value);
  data = data.filter(graph => graph.viewCount >= minViewCount &amp;&amp; graph.viewCount <= maxViewCount);
  
  // 下载次数筛选
  const minDownloadCount = parseInt(document.getElementById(&#39;minDownloadCountRange&#39;).value);
  const maxDownloadCount = parseInt(document.getElementById(&#39;maxDownloadCountRange&#39;).value);
  data = data.filter(graph => graph.downloadCount >= minDownloadCount &amp;&amp; graph.downloadCount <= maxDownloadCount);
  
  filteredData = data;
  renderGraphGrid();
  updateResultCount();
}

// 重置筛选
function resetFilters() {
  // 重置领域筛选
  currentFilter = &#39;all&#39;;
  document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn => btn.classList.remove(&#39;active&#39;));
  document.querySelector(&#39;[data-filter="all"]&#39;).classList.add(&#39;active&#39;);
  
  // 重置其他筛选器
  document.getElementById(&#39;keywordFilter&#39;).value = &#39;&#39;;
  document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;
  document.getElementById(&#39;startDate&#39;).value = &#39;&#39;;
  document.getElementById(&#39;endDate&#39;).value = &#39;&#39;;
  
// 重置范围滑块
  const resetSliders = [
    { range: &#39;minNodesRange&#39;, value: &#39;minNodesValue&#39;, defaultVal: 0, displayVal: &#39;0&#39; },
    { range: &#39;maxNodesRange&#39;, value: &#39;maxNodesValue&#39;, defaultVal: 10000, displayVal: &#39;10000&#39; },
    { range: &#39;minEdgesRange&#39;, value: &#39;minEdgesValue&#39;, defaultVal: 0, displayVal: &#39;0&#39; },
    { range: &#39;maxEdgesRange&#39;, value: &#39;maxEdgesValue&#39;, defaultVal: 20000, displayVal: &#39;20000&#39; },
    { range: &#39;minDensityRange&#39;, value: &#39;minDensityValue&#39;, defaultVal: 0, displayVal: &#39;0.0&#39; },
    { range: &#39;maxDensityRange&#39;, value: &#39;maxDensityValue&#39;, defaultVal: 100, displayVal: &#39;10.0&#39; },
    { range: &#39;minEntityRichnessRange&#39;, value: &#39;minEntityRichnessValue&#39;, defaultVal: 0, displayVal: &#39;0.0&#39; },
    { range: &#39;maxEntityRichnessRange&#39;, value: &#39;maxEntityRichnessValue&#39;, defaultVal: 100, displayVal: &#39;10.0&#39; },
    { range: &#39;minRelationRichnessRange&#39;, value: &#39;minRelationRichnessValue&#39;, defaultVal: 0, displayVal: &#39;0.0&#39; },
    { range: &#39;maxRelationRichnessRange&#39;, value: &#39;maxRelationRichnessValue&#39;, defaultVal: 100, displayVal: &#39;10.0&#39; },
    { range: &#39;minViewCountRange&#39;, value: &#39;minViewCountValue&#39;, defaultVal: 0, displayVal: &#39;0&#39; },
    { range: &#39;maxViewCountRange&#39;, value: &#39;maxViewCountValue&#39;, defaultVal: 30000, displayVal: &#39;30000&#39; },
    { range: &#39;minDownloadCountRange&#39;, value: &#39;minDownloadCountValue&#39;, defaultVal: 0, displayVal: &#39;0&#39; },
    { range: &#39;maxDownloadCountRange&#39;, value: &#39;maxDownloadCountValue&#39;, defaultVal: 5000, displayVal: &#39;5000&#39; }
  ];
  
  resetSliders.forEach(slider => {
    const rangeElement = document.getElementById(slider.range);
    const valueElement = document.getElementById(slider.value);
    if (rangeElement &amp;&amp; valueElement) {
      rangeElement.value = slider.defaultVal;
      valueElement.textContent = slider.displayVal;
    }
  });
  
  // 隐藏清除按钮
  const clearBtn = document.querySelector(&#39;.clear-search-btn&#39;);
  if (clearBtn) clearBtn.classList.add(&#39;hidden&#39;);
  
  // 重新应用筛选
  applyFilters();
  
  window.showNotification(&#39;筛选条件已重置&#39;, &#39;info&#39;);
}

// 渲染图谱网格
function renderGraphGrid() {
  const container = document.getElementById(&#39;graphGrid&#39;);
  container.innerHTML = &#39;&#39;;
  
  filteredData.forEach((graph, index) => {
    const card = createGraphCard(graph);
    card.style.animationDelay = `${index * 0.1}s`;
    container.appendChild(card);
  });
}

// 创建图谱卡片
function createGraphCard(graph) {
  const card = document.createElement(&#39;div&#39;);
  card.className = &#39;card bg-base-100 shadow-soft graph-card fade-in&#39;;
  card.setAttribute(&#39;data-repeatable&#39;, &#39;true&#39;);
  card.setAttribute(&#39;data-type&#39;, &#39;card&#39;);
  
  const isFavorited = window.APP_GLOBALS.favorites.isFavorited(graph.id);
  
  card.innerHTML = `
    <figure class="relative">
      <img src="${graph.image}" alt="${graph.title}" class="graph-card-image w-full" />
      <div class="absolute top-4 right-4">
        <div class="badge badge-primary domain-badge">${graph.domain}</div>
      </div>
    </figure>
    <div class="card-body p-6">
      <div class="card-title-section">
        <h3 class="card-title text-lg font-semibold" data-type="text">${graph.title}</h3>
      </div>
      
      <div class="card-description">
        <p class="text-base-content/70 text-sm line-clamp-3" data-type="text">${graph.description}</p>
      </div>
      
      <div class="card-meta-section">
        <div class="provider-info">
          <span class="iconify" data-icon="heroicons:user" data-width="14"></span>
          <span>${graph.provider}</span>
        </div>
      </div>
      
      <div class="card-stats-section">
        <div class="stats-info">
          <span class="flex items-center gap-1">
            <span class="iconify" data-icon="heroicons:circle" data-width="12"></span>
            ${graph.nodes}
          </span>
          <span class="flex items-center gap-1">
            <span class="iconify" data-icon="heroicons:arrow-right" data-width="12"></span>
            ${graph.edges}
          </span>
          <span class="flex items-center gap-1">
            <span class="iconify" data-icon="heroicons:eye" data-width="12"></span>
            ${graph.viewCount}
          </span>
          <span class="flex items-center gap-1">
            <span class="iconify" data-icon="heroicons:arrow-down-tray" data-width="12"></span>
            ${graph.downloadCount}
          </span>
        </div>
        <button class="btn btn-ghost btn-xs favorite-btn ${isFavorited ? &#39;favorited&#39; : &#39;&#39;}" onclick="toggleFavorite(&#39;${graph.id}&#39;, event)" data-type="button">
          <span class="iconify" data-icon="${isFavorited ? &#39;heroicons:heart-solid&#39; : &#39;heroicons:heart&#39;}" data-width="16"></span>
        </button>
      </div>
    </div>
  `;
  
  // 添加点击事件 - 传递图谱ID参数
  card.addEventListener(&#39;click&#39;, function(e) {
    if (!e.target.closest(&#39;.btn&#39;)) {
      viewGraphDetail(graph.id);
    }
  });
  
  // 添加悬停预览
  card.addEventListener(&#39;mouseenter&#39;, function(e) {
    showGraphPreview(graph, e);
  });
  
  card.addEventListener(&#39;mouseleave&#39;, function() {
    hideGraphPreview();
  });
  
  return card;
}

// 显示图谱预览
function showGraphPreview(graph, event) {
  const tooltip = document.createElement(&#39;div&#39;);
  tooltip.className = &#39;graph-preview-tooltip&#39;;
  tooltip.id = &#39;graphPreviewTooltip&#39;;
  
  tooltip.innerHTML = `
    <h4 class="font-semibold mb-2">${graph.title}</h4>
    <p class="text-sm text-base-content/70 mb-3">${graph.description}</p>
    <div class="space-y-2 text-xs">
      <div class="flex justify-between">
        <span>提供者:</span>
        <span class="font-medium">${graph.provider}</span>
      </div>
      <div class="flex justify-between">
        <span>创建日期:</span>
        <span class="font-medium">${graph.createDate}</span>
      </div>
      <div class="flex justify-between">
        <span>浏览次数:</span>
        <span class="font-medium">${graph.viewCount}</span>
      </div>
      <div class="flex justify-between">
        <span>下载次数:</span>
        <span class="font-medium">${graph.downloadCount}</span>
      </div>
    </div>
  `;
  
  document.body.appendChild(tooltip);
  
  // 获取卡片位置（视口坐标）
  const rect = event.currentTarget.getBoundingClientRect();
  const tooltipWidth = 320; // max-width of tooltip
  const gap = 10;
  
  // 获取滚动偏移量，将视口坐标转换为文档坐标
  const scrollX = window.scrollX || window.pageXOffset;
  const scrollY = window.scrollY || window.pageYOffset;
  
  // 先判断卡片右侧是否有足够空间显示 tooltip
  // 如果卡片右边界 + gap + tooltipWidth 超出视窗，则显示在左侧
  const showOnLeft = rect.right + gap + tooltipWidth > window.innerWidth;
  
  if (showOnLeft) {
    // 显示在卡片左侧
    tooltip.style.left = `${rect.left + scrollX - tooltipWidth - gap}px`;
  } else {
    // 显示在卡片右侧
    tooltip.style.left = `${rect.right + scrollX + gap}px`;
  }
  
  // 设置垂直位置（与卡片顶部对齐）
  tooltip.style.top = `${rect.top + scrollY}px`;
  
  // 获取 tooltip 实际尺寸后检查垂直边界
  const tooltipRect = tooltip.getBoundingClientRect();
  
  // 如果 tooltip 底部超出视窗底部
  if (tooltipRect.bottom > window.innerHeight) {
    // 将 tooltip 底部与视窗底部对齐
    tooltip.style.top = `${scrollY + window.innerHeight - tooltipRect.height - gap}px`;
  }
  
  // 如果 tooltip 顶部超出视窗顶部
  if (tooltip.getBoundingClientRect().top < 0) {
    tooltip.style.top = `${scrollY + gap}px`;
  }
  
  setTimeout(() => {
    tooltip.classList.add(&#39;show&#39;);
  }, 50);
}

// 隐藏图谱预览
function hideGraphPreview() {
  const tooltip = document.getElementById(&#39;graphPreviewTooltip&#39;);
  if (tooltip) {
    tooltip.remove();
  }
}

// 切换收藏状态
async function toggleFavorite(graphId, event) {
  event.stopPropagation();
  
  const graph = allGraphs.find(g =&gt; g.id === graphId);
  const btn = event.target.closest(&#39;.favorite-btn&#39;);
  const heartIcon = btn.querySelector(&#39;.iconify&#39;);
  
  if (graph) {
    await window.APP_GLOBALS.favorites.toggle(graphId, graph);
    
    // 更新心形图标状态
    const isFavorited = window.APP_GLOBALS.favorites.isFavorited(graphId);
    
    if (isFavorited) {
      heartIcon.setAttribute(&#39;data-icon&#39;, &#39;heroicons:heart-solid&#39;);
      btn.classList.add(&#39;favorited&#39;);
    } else {
      heartIcon.setAttribute(&#39;data-icon&#39;, &#39;heroicons:heart&#39;);
      btn.classList.remove(&#39;favorited&#39;);
    }
  }
}

// 跳转到图谱详情页，带上graphId参数
function viewGraphDetail(graphId) {
  const isInIframe = window.self !== window.top;
  
  if (isInIframe) {
    window.parent.postMessage({
      type: &#39;iframeNavigation&#39;,
      targetPageId: &#39;graph_detail_page&#39;,
      params: { graphId: graphId }
    }, &#39;*&#39;);
  } else {
    window.location.href = `/graph/graph_detail.html?id=${graphId}`;
  }
}

// 更新结果计数
function updateResultCount() {
  const countElement = document.getElementById(&#39;resultCount&#39;);
  countElement.textContent = `共找到 ${filteredData.length} 个图谱`;
}
</script>
  

<script>
    setTimeout(() => {
      Holder.run({
        domain: "placehold.co"
      })
    }, 100)
  </script></body></html>'></iframe>
                    </div>
                  </div>

                </body>
                </html>
            