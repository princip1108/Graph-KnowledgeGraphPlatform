# 网站部署指南 (Deployment Guide)

这份指南将一步步教你如何将你的 Knowledge Graph Platform 项目从本地开发环境部署到服务器上。

## 1. 什么是部署？

部署（Deployment）就是将你的代码运行在通过网络可以访问的计算机（服务器）上，让其他人也能访问你的网站。

通常包含以下几个核心环节：
1.  **构建 (Build)**：将 Java 源代码打包成可执行的 jar 文件。
2.  **环境准备**：在服务器上安装 Java、数据库 (MySQL, Neo4j) 等。
3.  **运行**：启动程序。

为了简化第2和第3步，我们为你配置了 **Docker**。使用 Docker，你不需要在服务器上一个个手动安装数据库和环境，只需要运行一个命令，哪怕到了全新的服务器上也能一键启动。

---

## 2. 准备工作

### 2.1 确保本地代码能运行
首先确保你的代码没有报错。

### 2.2 打包应用程序
在你的项目目录 `d:\idea projects\KnowledgeGraphPlatform\demo` 下，打开终端（Terminal）运行以下命令：

```bash
# Windows (PowerShell/CMD)
./mvnw clean package -DskipTests
```

执行成功后，会在 `demo/target/` 目录下生成一个类似 `demo-0.0.1-SNAPSHOT.jar` 的文件。

---

## 3. 使用 Docker 部署 (推荐)

我在你的项目中添加了两个关键文件：
*   `Dockerfile`: 告诉 Docker 如何根据你的 jar 包制作镜像。
*   `docker-compose.yml`: 定义了如何同时启动 网站应用 + MySQL + Neo4j，并把它们自动连接起来。

### 方案 A：在本地体验部署 (Windows)
如果你要在自己的电脑上模拟服务器运行：

1.  安装 [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop/) 并启动。
2.  在 `demo` 目录下运行终端。
3.  输入命令：
    ```bash
    docker-compose up -d --build
    ```
4.  等待几分钟，Docker 会自动下载数据库镜像并启动项目。
5.  访问 `http://localhost:8080` 即可。

### 方案 B：部署到远程 Linux 服务器 (正式上线)

这是真正的“上线”流程。

#### 第一步：购买服务器
你需要购买一台云服务器 (阿里云/腾讯云/AWS等)。
*   **操作系统建议**：Ubuntu 22.04 LTS
*   **配置建议**：因为你有 Java + MySQL + Neo4j，建议至少 **2核 CPU，4GB 内存** (Neo4j 和 Java 都比较吃内存)。

#### 第二步：连接服务器
使用 SSH 软件 (如 Xshell, Putty 或 VS Code SSH) 连接到你的服务器IP。

#### 第三步：安装环境 (只需做一次)
在服务器上安装 Docker：

```bash
# 更新软件源
sudo apt update
# 安装 Docker
sudo apt install docker.io docker-compose -y
```

#### 第四步：上传文件
你需要将以下文件上传到服务器的一个文件夹（比如 `/home/ubuntu/kg-platform`）：
1.  `docker-compose.yml`
2.  `Dockerfile`
3.  `target/demo-0.0.1-SNAPSHOT.jar` (确保是你刚打包好的)

你可以使用 SCP 命令或者 filezilla 软件上传。

#### 第五步：启动服务
在服务器的文件夹内运行：

```bash
# 启动所有服务 (-d 表示后台运行)
sudo docker-compose up -d --build
```
> 注意：有些新版 docker 命令是 `docker compose` (不带横杠)，如果报错可以试试。

#### 第六步：开放端口
去你的云服务器控制台（网页后台），找到“安全组”或“防火墙”设置，允许以下端口的入站流量：
*   `8080` (你的网站)
*   `7474` (Neo4j 控制台，如果需要远程看图数据库)
*   `22` (SSH，默认应该开了)

现在，你就可以通过 `http://你的服务器IP:8080` 访问你的网站了！

---

## 4. 常用维护命令

**查看运行日志** (如果网站打不开了，用这个看报错)：
```bash
docker-compose logs -f app
```

**停止服务**：
```bash
docker-compose down
```

**重启服务**：
```bash
docker-compose restart
```
