# 知识图谱领域分类智能化校验方案

## 1. 背景与目标
在用户上传或创建知识图谱时，需要选择图谱所属的“领域分类”（如医疗、金融、法律等）。为了保证平台数据的准确性和分类的规范性，通过系统自动化的方式对用户的选择进行检查，并在发现不符时进行纠正或提示。本方案旨在罗列多种可能的技术实现路径与交互模式，供技术选型参考。

---

## 2. 方案概览
我们从 **“介入时机”**（何时检查）和 **“处理力度”**（如何纠正）两个维度，设计了以下四种方案。

| 方案ID | 方案名称 | 核心机制 | 用户感知 | 技术复杂度 | 推荐指数 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **A** | **实时交互引导方案** | 上传前根据名称/描述推荐 | 辅助式，体验好 | ⭐⭐ | ⭐⭐⭐⭐ |
| **B** | **异步AI审计方案** | 上传后后台分析，通知修正 | 弱管控，不阻塞 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| **C** | **强制阻断校验方案** | 提交时强制检查，不符则拒 | 强管控，门槛高 | ⭐⭐⭐ | ⭐⭐ |
| **D** | **众包投票校正方案** | 发布后由社区用户投票纠错 | 去中心化，滞后 | ⭐ | ⭐⭐⭐ |

---

## 3. 详细方案阐述

### 方案 A：实时交互引导方案 (Assistive Classification)
**核心思想**：防患于未然。既然用户可能选错，不如在用户选择之前，系统就根据已填写的“图谱名称”、“图谱描述”或“预览文件”，自动给出一个高置信度的推荐。

*   **流程**：
    1.  用户填写图谱名称和简介。
    2.  前端触发API，后端利用NLP（关键词匹配或预训练模型）快速判断领域。
    3.  界面上自动选中系统推荐的分类，并标注“系统推荐”。
    4.  用户如果不认可，可以手动修改，此时系统不再干预，仅记录日志。
*   **技术实现**：
    *   **算法**：TF-IDF 关键词提取，或 BERT 短文本分类。
    *   **数据源**：输入框文本。
*   **优点**：用户摩擦小，引导性强，开发成本适中。
*   **缺点**：仅基于元数据判断，如果用户“挂羊头卖狗肉”（描述与实际内容不符），无法通过此方案检测。

### 方案 B：异步AI审计方案 (Asynchronous AI Auditing)
**核心思想**：先放行，后审计。保证上传流程的丝滑，利用后台强大的算力对图谱内容进行深度扫描。

*   **流程**：
    1.  用户正常提交并选择分类，图谱立即呈“审核中”或“已发布”状态。
    2.  后台 MQ 触发分析任务，读取图谱的节点标签（Labels）、关系类型（Relationship Types）以及部分属性值。
    3.  系统将提取的特征输入分类模型或 LLM（大模型）。
    4.  **判定逻辑**：
        *   **完全匹配**：流程结束。
        *   **置信度低**：系统标记该图谱为“分类存疑”，推送到管理员后台人工复核。
        *   **确实不符**（高置信度）：系统发送站内信通知用户：“系统检测到您的图谱更倾向于[XX领域]，建议您修改”，或者根据配置自动修正并通知。
*   **技术实现**：
    *   **算法**：LLM (Prompt Engineering: "根据以下Schema判断由于什么领域...")。
    *   **数据源**：Neo4j 中的 Schema 信息（节点类型、关系分布）。
*   **优点**：识别准确率最高（基于真实数据），不阻塞用户UI，兼顾体验与质量。
*   **缺点**：反馈有延迟，架构相对复杂（需要消息队列和异步任务）。

### 方案 C：强制阻断校验方案 (Pre-flight Blocking Check)
**核心思想**：严格管控。在数据入库前进行强制检查，只有通过系统校验的分类才能提交。

*   **流程**：
    1.  用户上传文件（Json/Excel/CSV）。
    2.  后端立即解析文件内容，进行全量或抽样分析。
    3.  系统计算出该内容的分类。
    4.  如果用户选择的分类与系统计算的不一致，**前端报错阻断**：“检测到内容属于[XX领域]，请修改分类后重新提交。”
*   **技术实现**：
    *   需要在文件上传流中实时处理数据。
*   **优点**：平台数据的绝对纯净和规范。
*   **缺点**：用户体验差（挫败感强），大文件上传时等待时间过长（Timeout风险）。

### 方案 D：众包投票校正方案 (Community Crowdsourcing)
**核心思想**：依靠社区力量。系统“无为而治”，让浏览图谱的用户来反馈。

*   **流程**：
    1.  用户自由选择分类发布。
    2.  在图谱详情页增加“反馈分类错误”按钮。
    3.  当某图谱收到超过 N 个用户的报错，或高级用户（Expert）提交了修正建议时。
    4.  系统自动更改分类或通知图谱作者整改。
*   **技术实现**：
    *   简单的计数器和投票逻辑。
*   **优点**：技术实现最简单，能处理极其复杂的边缘情况（AI 看不懂但人看得懂）。
*   **缺点**：实时性差，早期平台活跃度不够时效果几乎为零。

---

## 4. 技术选型建议 (Technology Stack)

针对 **方案 B (异步AI审计)** 这一最推荐方案，具体技术栈建议如下：

1.  **特征提取层 (Java/Spring Boot)**：
    *   使用 Neo4j Driver 获取图谱元数据：`CALL db.schema.visualization()` 获取节点和关系的定义。
    *   抽样提取 Top 50 出现频率最高的节点文本。

2.  **智能判定层 (Model)**：
    *   **低成本选项**：构建一个包含行业关键词的词库（如由于医疗：[疾病, 药品, 诊断...]），计算 Jaccard 相似度或进行加权打分。
    *   **高性能选项**：接入本地部署的 DeepSeek/Llama 或 在线 API。
        *   *Prompt 示例*：“我有一个知识图谱，包含节点类型：[Person, Movie]，关系：[ACTED_IN, DIRECTED]，请判断它属于哪个领域？（选项：医疗/金融/娱乐/教育）”

3.  **反馈层**：
    *   利用现有的 `MessageService` 发送系统通知。

## 5. 总结
建议分阶段实施：
*   **第一阶段（MVP）**：实施 **方案 A**。在前端增加简单的关键词映射推荐，提升用户初次选择的准确率。
*   **第二阶段**：实施 **方案 B**。引入后台任务，基于图谱实际数据进行周期性扫描和修正提醒。
