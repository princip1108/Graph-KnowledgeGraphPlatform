# 自动化索引维护说明

**创建日期**: 2026-02-04
**状态**: 已实现 (Implemented)

---

## 1. 功能概述

为了避免手动维护数据库索引的繁琐，我们引入了 `DatabaseInitializer` 组件。
该组件会在每次 Spring Boot 应用启动时自动运行，检查由于性能原因必须存在的 Neo4j 索引。

**文件位置**: `src/main/java/com/sdu/kgplatform/config/DatabaseInitializer.java`

## 2. 自动维护的索引列表

系统会自动“幂等”地（即如果存在则跳过，不存在则创建）执行以下操作：

### 2.1 唯一性约束 (Constraints)
| 名称 | 目标节点 | 属性 | 说明 |
| :--- | :--- | :--- | :--- |
| `entity_nodeid_unique` | `:Entity` | `nodeId` | 保证业务主键唯一，防止数据重复 |

### 2.2 性能索引 (Indexes)
| 名称 | 目标节点 | 属性 | 说明 |
| :--- | :--- | :--- | :--- |
| `entity_graphid_index` | `:Entity` | `graphId` | **核心优化**: 解决图谱详情加载慢 |
| `entity_name_index` | `:Entity` | `name` | 优化按名称搜索 |
| `entity_type_index` | `:Entity` | `type` | 优化按类型筛选 |

## 3. 使用方法

### 3.1 启用方式
**无需任何操作**。只要您启动项目（Maven Run 或 Docker 重启），程序会自动检测并修复缺失的索引。

### 3.2 查看日志
启动时请关注控制台日志：

```text
INFO ... DatabaseInitializer : === 开始检查 Neo4j 数据库索引与约束 ===
INFO ... DatabaseInitializer : 已验证约束: entity_nodeid_unique ...
INFO ... DatabaseInitializer : 已验证索引: entity_graphid_index ...
INFO ... DatabaseInitializer : === Neo4j 数据库索引检查完成 ===
```

## 4. 注意事项
- 本自动化脚本仅涵盖 **Neo4j** 部分。
- **MySQL 索引** 修改属于 DDL (Schema Change)，生产环境通常不建议自动执行，因此仍需您手动执行 `数据库索引优化计划.md` 中的 SQL 语句，或使用 Flyway 等专业迁工具。
